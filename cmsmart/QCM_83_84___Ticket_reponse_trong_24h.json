{
  "name": "QCM 83 84 - Ticket reponse trong 24h",
  "nodes": [
    {
      "parameters": {},
      "id": "a2ea9e1e-255d-4cc8-9bb7-21e01afcf61b",
      "name": "When clicking ‘Test workflow’",
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        -2200,
        4960
      ]
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "options": {}
      },
      "id": "25b2cf9c-7857-4683-bc24-97e413713167",
      "name": "Aggregate2",
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        6120,
        3820
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "a652141b-108c-48b9-801a-56a259585aaa",
              "leftValue": "={{ $json.lastRespone }}",
              "rightValue": "Agent",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "da217e2c-7a1d-4bc7-a29c-86809ff5435f",
      "name": "Check Agent Reply1",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        5900,
        3940
      ]
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "options": {}
      },
      "id": "7b31c572-a94c-42a6-8570-6ae5a9dd79c8",
      "name": "Aggregate3",
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        6140,
        4060
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.cloodo.com/mautic.php",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {}
          ]
        },
        "sendBody": true,
        "contentType": "multipart-form-data",
        "bodyParameters": {
          "parameters": [
            {
              "name": "email",
              "value": "={{ $json.data[0].agenEmail }}"
            },
            {
              "name": "uname",
              "value": "={{ $json.data[0].agentName }}"
            },
            {
              "name": "subject",
              "value": "=Respond to tickets when customers respond"
            },
            {
              "name": "send_mail",
              "value": "cmsmart"
            },
            {
              "name": "email_id",
              "value": "109"
            },
            {
              "name": "content",
              "value": "=<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Ticket Closure Reminder</title>\n</head>\n\n<body style=\"font-family: Arial, sans-serif; color: #333; line-height: 1.6; margin: 0;\">\n    <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"background-color: #fff;\">\n        <!-- Content -->\n        <tr>\n            <td style=\"font-size: 14px; color: black\">\n                <p>Dear {{ $json.data[0].agentName }},</p>\n<p>I hope this message finds you well.</p>\n<p>This is a friendly reminder to please ensure that all customer tickets are responded to in a timely manner. Once a customer responds, it is important to follow up within 24 hours. Failure to do so will result in points being deducted from the CmsMart Admin system.</p>\n\n<p>Key points to remember:</p>\n\n<ul>\n<li>Ensure timely responses to customer feedback.</li>\n<li>Reply within 24 hours to avoid penalties.</li>\n<li>Points will be deducted from the CmsMart Admin for slow responses.</li>\n</ul>\n\n<p>We appreciate your cooperation and concern for this issue.</p>\n\n<p>Here is the ticket you need to respond to:</p>\n\n                <table width=\"100%\" cellpadding=\"5\" cellspacing=\"0\" style=\"border-collapse: collapse;\">\n                    <tr>\n                        <th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Ticket ID</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Subject</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Client</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Status</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Type</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Project</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Agent</th>\n                      \n                    </tr>\n\n               {{ $json[\"data\"].map(item => `\n                <tr>\n                    <td style=\"border-bottom: 1px solid #ddd; padding: 8px;\"><a href=\"https://worksuite.cloodo.com/apps/tickets/all-tickets/${item.idTicket}\" style=\"color: #007bff; text-decoration: none;\">Ticket${item.numberTicket}</a></td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.subjectTicket}</td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.nameClient}</td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.statusTicket}</td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.typeTicket}</td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.projectTicket}</td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.agentName}</td>\n                </tr>\n                `).join('') }}\n                </table>\n\n                <p>Best regards,</p>\n                <p>Cms Admin</p>\n            </td>\n        </tr>\n    </table>\n</body>\n\n</html>\n"
            }
          ]
        },
        "options": {}
      },
      "id": "0f250876-1b99-4d62-9ecb-57d7ece90ff8",
      "name": "Send mail Reply Ticket1",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        6360,
        4060
      ]
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "https://docs.google.com/spreadsheets/d/1lM_TG2ExLdbs1YoBcaFzBFscVqB3MOEFjBFnvE9kAa0/edit?gid=0#gid=0",
          "mode": "url"
        },
        "sheetName": {
          "__rl": true,
          "value": 1298489612,
          "mode": "list",
          "cachedResultName": "Phuong",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lM_TG2ExLdbs1YoBcaFzBFscVqB3MOEFjBFnvE9kAa0/edit#gid=1298489612"
        },
        "options": {}
      },
      "id": "f9edb03a-9e8d-4ad4-903f-e021395403db",
      "name": "Phuong2",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        5440,
        3940
      ],
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "P5h6CdXmV7twphIt",
          "name": "Canh Google Sheets"
        }
      }
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "options": {}
      },
      "id": "14817bef-3250-4296-b415-d549ca1a7362",
      "name": "Aggregate4",
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        6160,
        3300
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.cloodo.com/mautic.php",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {}
          ]
        },
        "sendBody": true,
        "contentType": "multipart-form-data",
        "bodyParameters": {
          "parameters": [
            {
              "name": "email",
              "value": "={{ $json.data[0].agenEmail }}"
            },
            {
              "name": "uname",
              "value": "={{ $json.data[0].agentName }}"
            },
            {
              "name": "subject",
              "value": "=Closed Ticket Client No Replies"
            },
            {
              "name": "send_mail",
              "value": "cmsmart"
            },
            {
              "name": "email_id",
              "value": "109"
            },
            {
              "name": "content",
              "value": "=<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Ticket Closure Reminder</title>\n</head>\n\n<body style=\"font-family: Arial, sans-serif; color: #333; line-height: 1.6; margin: 0;\">\n    <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"background-color: #fff;\">\n        <!-- Content -->\n        <tr>\n            <td style=\"font-size: 14px; color: black\">\n                <p>Dear {{ $json.data[0].agentName }},</p>\n\n                <p>Here is a friendly reminder about closing tickets:</p>\n\n                <ul>\n                    <li>Tickets must be closed within 15 days of the customer not responding.</li>\n                    <li>If the ticket is not closed after 24 hours, points will be deducted from the CmsMart Admin account.</li>\n                </ul>\n\n                <p>Please ensure that all tickets are properly managed and closed within the specified time frame.</p>\n\n                <p>Thank you for your attention to this matter.</p>\n                <p>Here are the links to the tickets you need to close:</p>\n\n                <table width=\"100%\" cellpadding=\"5\" cellspacing=\"0\" style=\"border-collapse: collapse;\">\n                    <tr>\n                        <th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Ticket ID</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Subject</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Client</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Status</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Type</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Project</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Agent</th>\n                      \n                    </tr>\n\n               {{ $json[\"data\"].map(item => `\n                <tr>\n                    <td style=\"border-bottom: 1px solid #ddd; padding: 8px;\"><a href=\"https://worksuite.cloodo.com/apps/tickets/all-tickets/${item.idTicket}\" style=\"color: #007bff; text-decoration: none;\">Ticket${item.numberTicket}</a></td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.subjectTicket}</td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.nameClient}</td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.statusTicket}</td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.typeTicket}</td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.projectTicket}</td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.agentName}</td>\n                </tr>\n                `).join('') }}\n                \n\n                </table>\n\n                <p>Best regards,</p>\n                <p>Cms Admin</p>\n            </td>\n        </tr>\n    </table>\n</body>\n\n</html>\n"
            }
          ]
        },
        "options": {}
      },
      "id": "c0815270-a9eb-47b9-b9c9-80648feddff3",
      "name": "Send mail closed ticket2",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        6340,
        3300
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "a652141b-108c-48b9-801a-56a259585aaa",
              "leftValue": "={{ $json.lastRespone }}",
              "rightValue": "Agent",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "fd7744b0-bb47-4cfa-9bbe-3c594be6b092",
      "name": "Check Agent Reply2",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        5900,
        3400
      ]
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "options": {}
      },
      "id": "fb79f426-b452-44f6-a930-51e401a78df6",
      "name": "Aggregate5",
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        6140,
        3560
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.cloodo.com/mautic.php",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {}
          ]
        },
        "sendBody": true,
        "contentType": "multipart-form-data",
        "bodyParameters": {
          "parameters": [
            {
              "name": "email",
              "value": "={{ $json.data[0].agenEmail }}"
            },
            {
              "name": "uname",
              "value": "={{ $json.data[0].agentName }}"
            },
            {
              "name": "subject",
              "value": "=Respond to tickets when customers respond"
            },
            {
              "name": "send_mail",
              "value": "cmsmart"
            },
            {
              "name": "email_id",
              "value": "109"
            },
            {
              "name": "content",
              "value": "=<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Ticket Closure Reminder</title>\n</head>\n\n<body style=\"font-family: Arial, sans-serif; color: #333; line-height: 1.6; margin: 0;\">\n    <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"background-color: #fff;\">\n        <!-- Content -->\n        <tr>\n            <td style=\"font-size: 14px; color: black\">\n                <p>Dear {{ $json.data[0].agentName }},</p>\n<p>I hope this message finds you well.</p>\n<p>This is a friendly reminder to please ensure that all customer tickets are responded to in a timely manner. Once a customer responds, it is important to follow up within 24 hours. Failure to do so will result in points being deducted from the CmsMart Admin system.</p>\n\n<p>Key points to remember:</p>\n\n<ul>\n<li>Ensure timely responses to customer feedback.</li>\n<li>Reply within 24 hours to avoid penalties.</li>\n<li>Points will be deducted from the CmsMart Admin for slow responses.</li>\n</ul>\n\n<p>We appreciate your cooperation and concern for this issue.</p>\n\n<p>Here is the ticket you need to respond to:</p>\n\n                <table width=\"100%\" cellpadding=\"5\" cellspacing=\"0\" style=\"border-collapse: collapse;\">\n                    <tr>\n                        <th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Ticket ID</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Subject</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Client</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Status</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Type</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Project</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Agent</th>\n                      \n                    </tr>\n\n               {{ $json[\"data\"].map(item => `\n                <tr>\n                    <td style=\"border-bottom: 1px solid #ddd; padding: 8px;\"><a href=\"https://worksuite.cloodo.com/apps/tickets/all-tickets/${item.idTicket}\" style=\"color: #007bff; text-decoration: none;\">Ticket${item.numberTicket}</a></td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.subjectTicket}</td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.nameClient}</td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.statusTicket}</td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.typeTicket}</td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.projectTicket}</td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.agentName}</td>\n                </tr>\n                `).join('') }}\n                </table>\n\n                <p>Best regards,</p>\n                <p>Cms Admin</p>\n            </td>\n        </tr>\n    </table>\n</body>\n\n</html>\n"
            }
          ]
        },
        "options": {}
      },
      "id": "754b2d01-a328-4891-bd1f-8ecc6dacc027",
      "name": "Send mail Reply Ticket2",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        6320,
        3560
      ]
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "https://docs.google.com/spreadsheets/d/1lM_TG2ExLdbs1YoBcaFzBFscVqB3MOEFjBFnvE9kAa0/edit?gid=0#gid=0",
          "mode": "url"
        },
        "sheetName": {
          "__rl": true,
          "value": 1289877611,
          "mode": "list",
          "cachedResultName": "Huy",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lM_TG2ExLdbs1YoBcaFzBFscVqB3MOEFjBFnvE9kAa0/edit#gid=1289877611"
        },
        "options": {}
      },
      "id": "64db9ef3-6f09-45c4-b219-6ba4e1adf9a5",
      "name": "Huy2",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        5420,
        3420
      ],
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "P5h6CdXmV7twphIt",
          "name": "Canh Google Sheets"
        }
      }
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "options": {}
      },
      "id": "40b7ddb1-500e-4f21-91be-94eebb929ff6",
      "name": "Aggregate6",
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        6200,
        4300
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.cloodo.com/mautic.php",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {}
          ]
        },
        "sendBody": true,
        "contentType": "multipart-form-data",
        "bodyParameters": {
          "parameters": [
            {
              "name": "email",
              "value": "={{ $json.data[0].agenEmail }}"
            },
            {
              "name": "uname",
              "value": "={{ $json.data[0].agentName }}"
            },
            {
              "name": "subject",
              "value": "=Closed Ticket Client No Replies"
            },
            {
              "name": "send_mail",
              "value": "cmsmart"
            },
            {
              "name": "email_id",
              "value": "111"
            },
            {
              "name": "content",
              "value": "=<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Ticket Closure Reminder</title>\n</head>\n\n<body style=\"font-family: Arial, sans-serif; color: #333; line-height: 1.6; margin: 0;\">\n    <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"background-color: #fff;\">\n        <!-- Content -->\n        <tr>\n            <td style=\"font-size: 14px; color: black\">\n                <p>Dear {{ $json.data[0].agentName }},</p>\n\n                <p>Here is a friendly reminder about closing tickets:</p>\n\n                <ul>\n                    <li>Tickets must be closed within 15 days of the customer not responding.</li>\n                    <li>If the ticket is not closed after 24 hours, points will be deducted from the CmsMart Admin account.</li>\n                </ul>\n\n                <p>Please ensure that all tickets are properly managed and closed within the specified time frame.</p>\n\n                <p>Thank you for your attention to this matter.</p>\n                <p>Here are the links to the tickets you need to close:</p>\n\n                <table width=\"100%\" cellpadding=\"5\" cellspacing=\"0\" style=\"border-collapse: collapse;\">\n                    <tr>\n                        <th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Ticket ID</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Subject</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Client</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Status</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Type</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Project</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Agent</th>\n                      \n                    </tr>\n\n               {{ $json[\"data\"].map(item => `\n                <tr>\n                    <td style=\"border-bottom: 1px solid #ddd; padding: 8px;\"><a href=\"https://worksuite.cloodo.com/apps/tickets/all-tickets/${item.idTicket}\" style=\"color: #007bff; text-decoration: none;\">Ticket${item.numberTicket}</a></td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.subjectTicket}</td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.nameClient}</td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.statusTicket}</td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.typeTicket}</td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.projectTicket}</td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.agentName}</td>\n                </tr>\n                `).join('') }}\n                \n\n                </table>\n\n                <p>Best regards,</p>\n                <p>Cms Admin</p>\n            </td>\n        </tr>\n    </table>\n</body>\n\n</html>\n"
            }
          ]
        },
        "options": {}
      },
      "id": "44145393-2677-4c8a-8ff2-75d8699ae2c8",
      "name": "Send mail closed ticket3",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        6420,
        4300
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "a652141b-108c-48b9-801a-56a259585aaa",
              "leftValue": "={{ $json.lastRespone }}",
              "rightValue": "Agent",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "7f686948-e3e1-4d7c-a38d-383d3f2fad4d",
      "name": "Check Agent Reply3",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        6000,
        4400
      ]
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "options": {}
      },
      "id": "aa54a7e7-a8de-4d27-ae48-73e15d9bd96f",
      "name": "Aggregate7",
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        6180,
        4500
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.cloodo.com/mautic.php",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {}
          ]
        },
        "sendBody": true,
        "contentType": "multipart-form-data",
        "bodyParameters": {
          "parameters": [
            {
              "name": "email",
              "value": "={{ $json.data[0].agenEmail }}"
            },
            {
              "name": "uname",
              "value": "={{ $json.data[0].agentName }}"
            },
            {
              "name": "subject",
              "value": "=Respond to tickets when customers respond"
            },
            {
              "name": "send_mail",
              "value": "cmsmart"
            },
            {
              "name": "email_id",
              "value": "109"
            },
            {
              "name": "content",
              "value": "=<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Ticket Closure Reminder</title>\n</head>\n\n<body style=\"font-family: Arial, sans-serif; color: #333; line-height: 1.6; margin: 0;\">\n    <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"background-color: #fff;\">\n        <!-- Content -->\n        <tr>\n            <td style=\"font-size: 14px; color: black\">\n                <p>Dear {{ $json.data[0].agentName }},</p>\n<p>I hope this message finds you well.</p>\n<p>This is a friendly reminder to please ensure that all customer tickets are responded to in a timely manner. Once a customer responds, it is important to follow up within 24 hours. Failure to do so will result in points being deducted from the CmsMart Admin system.</p>\n\n<p>Key points to remember:</p>\n\n<ul>\n<li>Ensure timely responses to customer feedback.</li>\n<li>Reply within 24 hours to avoid penalties.</li>\n<li>Points will be deducted from the CmsMart Admin for slow responses.</li>\n</ul>\n\n<p>We appreciate your cooperation and concern for this issue.</p>\n\n<p>Here is the ticket you need to respond to:</p>\n\n                <table width=\"100%\" cellpadding=\"5\" cellspacing=\"0\" style=\"border-collapse: collapse;\">\n                    <tr>\n                        <th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Ticket ID</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Subject</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Client</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Status</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Type</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Project</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Agent</th>\n                      \n                    </tr>\n\n               {{ $json[\"data\"].map(item => `\n                <tr>\n                    <td style=\"border-bottom: 1px solid #ddd; padding: 8px;\"><a href=\"https://worksuite.cloodo.com/apps/tickets/all-tickets/${item.idTicket}\" style=\"color: #007bff; text-decoration: none;\">Ticket${item.numberTicket}</a></td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.subjectTicket}</td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.nameClient}</td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.statusTicket}</td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.typeTicket}</td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.projectTicket}</td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.agentName}</td>\n                </tr>\n                `).join('') }}\n                </table>\n\n                <p>Best regards,</p>\n                <p>Cms Admin</p>\n            </td>\n        </tr>\n    </table>\n</body>\n\n</html>\n"
            }
          ]
        },
        "options": {}
      },
      "id": "e8cb451d-ca6b-4d03-991a-d772bacab2b9",
      "name": "Send mail Reply Ticket3",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        6420,
        4500
      ]
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "https://docs.google.com/spreadsheets/d/1lM_TG2ExLdbs1YoBcaFzBFscVqB3MOEFjBFnvE9kAa0/edit?gid=0#gid=0",
          "mode": "url"
        },
        "sheetName": {
          "__rl": true,
          "value": 2073353188,
          "mode": "list",
          "cachedResultName": "Chi",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lM_TG2ExLdbs1YoBcaFzBFscVqB3MOEFjBFnvE9kAa0/edit#gid=2073353188"
        },
        "options": {}
      },
      "id": "4f6f6922-c69a-4675-96f0-1d3defa7d851",
      "name": "Chi2",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        5480,
        4400
      ],
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "P5h6CdXmV7twphIt",
          "name": "Canh Google Sheets"
        }
      }
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "options": {}
      },
      "id": "095205fb-661e-401f-909b-40b1f66c78b1",
      "name": "Aggregate8",
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        6260,
        4720
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.cloodo.com/mautic.php",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {}
          ]
        },
        "sendBody": true,
        "contentType": "multipart-form-data",
        "bodyParameters": {
          "parameters": [
            {
              "name": "email",
              "value": "={{ $json.data[0].agenEmail }}"
            },
            {
              "name": "uname",
              "value": "={{ $json.data[0].agentName }}"
            },
            {
              "name": "subject",
              "value": "=Closed Ticket Client No Replies"
            },
            {
              "name": "send_mail",
              "value": "cmsmart"
            },
            {
              "name": "email_id",
              "value": "109"
            },
            {
              "name": "content",
              "value": "=<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Ticket Closure Reminder</title>\n</head>\n\n<body style=\"font-family: Arial, sans-serif; color: #333; line-height: 1.6; margin: 0;\">\n    <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"background-color: #fff;\">\n        <!-- Content -->\n        <tr>\n            <td style=\"font-size: 14px; color: black\">\n                <p>Dear {{ $json.data[0].agentName }},</p>\n\n                <p>Here is a friendly reminder about closing tickets:</p>\n\n                <ul>\n                    <li>Tickets must be closed within 15 days of the customer not responding.</li>\n                    <li>If the ticket is not closed after 24 hours, points will be deducted from the CmsMart Admin account.</li>\n                </ul>\n\n                <p>Please ensure that all tickets are properly managed and closed within the specified time frame.</p>\n\n                <p>Thank you for your attention to this matter.</p>\n                <p>Here are the links to the tickets you need to close:</p>\n\n                <table width=\"100%\" cellpadding=\"5\" cellspacing=\"0\" style=\"border-collapse: collapse;\">\n                    <tr>\n                        <th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Ticket ID</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Subject</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Client</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Status</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Type</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Project</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Agent</th>\n                      \n                    </tr>\n\n               {{ $json[\"data\"].map(item => `\n                <tr>\n                    <td style=\"border-bottom: 1px solid #ddd; padding: 8px;\"><a href=\"https://worksuite.cloodo.com/apps/tickets/all-tickets/${item.idTicket}\" style=\"color: #007bff; text-decoration: none;\">Ticket${item.numberTicket}</a></td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.subjectTicket}</td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.nameClient}</td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.statusTicket}</td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.typeTicket}</td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.projectTicket}</td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.agentName}</td>\n                </tr>\n                `).join('') }}\n                \n\n                </table>\n\n                <p>Best regards,</p>\n                <p>Cms Admin</p>\n            </td>\n        </tr>\n    </table>\n</body>\n\n</html>\n"
            }
          ]
        },
        "options": {}
      },
      "id": "e30ee4ec-2c2e-4136-86f8-1def5f4432c0",
      "name": "Send mail closed ticket4",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        6480,
        4720
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "a652141b-108c-48b9-801a-56a259585aaa",
              "leftValue": "={{ $json.lastRespone }}",
              "rightValue": "Agent",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "83e5fe62-60bc-49f2-93b3-a9a927021eb4",
      "name": "Check Agent Reply4",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        6020,
        4820
      ]
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "options": {}
      },
      "id": "8f2a662a-a68a-4209-826e-18d2ebf182cb",
      "name": "Aggregate9",
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        6280,
        4920
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.cloodo.com/mautic.php",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {}
          ]
        },
        "sendBody": true,
        "contentType": "multipart-form-data",
        "bodyParameters": {
          "parameters": [
            {
              "name": "email",
              "value": "={{ $json.data[0].agenEmail }}"
            },
            {
              "name": "uname",
              "value": "={{ $json.data[0].agentName }}"
            },
            {
              "name": "subject",
              "value": "=Respond to tickets when customers respond"
            },
            {
              "name": "send_mail",
              "value": "cmsmart"
            },
            {
              "name": "email_id",
              "value": "109"
            },
            {
              "name": "content",
              "value": "=<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Ticket Closure Reminder</title>\n</head>\n\n<body style=\"font-family: Arial, sans-serif; color: #333; line-height: 1.6; margin: 0;\">\n    <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"background-color: #fff;\">\n        <!-- Content -->\n        <tr>\n            <td style=\"font-size: 14px; color: black\">\n                <p>Dear {{ $json.data[0].agentName }},</p>\n<p>I hope this message finds you well.</p>\n<p>This is a friendly reminder to please ensure that all customer tickets are responded to in a timely manner. Once a customer responds, it is important to follow up within 24 hours. Failure to do so will result in points being deducted from the CmsMart Admin system.</p>\n\n<p>Key points to remember:</p>\n\n<ul>\n<li>Ensure timely responses to customer feedback.</li>\n<li>Reply within 24 hours to avoid penalties.</li>\n<li>Points will be deducted from the CmsMart Admin for slow responses.</li>\n</ul>\n\n<p>We appreciate your cooperation and concern for this issue.</p>\n\n<p>Here is the ticket you need to respond to:</p>\n\n                <table width=\"100%\" cellpadding=\"5\" cellspacing=\"0\" style=\"border-collapse: collapse;\">\n                    <tr>\n                        <th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Ticket ID</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Subject</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Client</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Status</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Type</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Project</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Agent</th>\n                      \n                    </tr>\n\n               {{ $json[\"data\"].map(item => `\n                <tr>\n                    <td style=\"border-bottom: 1px solid #ddd; padding: 8px;\"><a href=\"https://worksuite.cloodo.com/apps/tickets/all-tickets/${item.idTicket}\" style=\"color: #007bff; text-decoration: none;\">Ticket${item.numberTicket}</a></td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.subjectTicket}</td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.nameClient}</td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.statusTicket}</td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.typeTicket}</td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.projectTicket}</td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.agentName}</td>\n                </tr>\n                `).join('') }}\n                </table>\n\n                <p>Best regards,</p>\n                <p>Cms Admin</p>\n            </td>\n        </tr>\n    </table>\n</body>\n\n</html>\n"
            }
          ]
        },
        "options": {}
      },
      "id": "8f669a7a-d024-4b10-9a04-a984c968c326",
      "name": "Send mail Reply Ticket4",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        6480,
        4920
      ]
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "https://docs.google.com/spreadsheets/d/1lM_TG2ExLdbs1YoBcaFzBFscVqB3MOEFjBFnvE9kAa0/edit?gid=0#gid=0",
          "mode": "url"
        },
        "sheetName": {
          "__rl": true,
          "value": 548962283,
          "mode": "list",
          "cachedResultName": "Chau",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lM_TG2ExLdbs1YoBcaFzBFscVqB3MOEFjBFnvE9kAa0/edit#gid=548962283"
        },
        "options": {}
      },
      "id": "5c4a5986-8b90-4980-a309-c36d93414f2e",
      "name": "Chau2",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        5500,
        4820
      ],
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "P5h6CdXmV7twphIt",
          "name": "Canh Google Sheets"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.cloodo.com/mautic.php",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {}
          ]
        },
        "sendBody": true,
        "contentType": "multipart-form-data",
        "bodyParameters": {
          "parameters": [
            {
              "name": "email",
              "value": "={{ $json.data[0].agenEmail }}"
            },
            {
              "name": "uname",
              "value": "={{ $json.data[0].agentName }}"
            },
            {
              "name": "subject",
              "value": "=Closed Ticket Client No Replies"
            },
            {
              "name": "send_mail",
              "value": "cmsmart"
            },
            {
              "name": "email_id",
              "value": "111"
            },
            {
              "name": "content",
              "value": "=<!DOCTYPE html>\n<html lang=\"en\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Ticket Closure Reminder</title>\n</head>\n\n<body style=\"font-family: Arial, sans-serif; color: #333; line-height: 1.6; margin: 0;\">\n    <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"background-color: #fff;\">\n        <!-- Content -->\n        <tr>\n            <td style=\"font-size: 14px; color: black\">\n                <p>Dear {{ $json.data[0].agentName }},</p>\n\n                <p>Here is a friendly reminder about closing tickets:</p>\n\n                <ul>\n                    <li>Tickets must be closed within 15 days of the customer not responding.</li>\n                    <li>If the ticket is not closed after 24 hours, points will be deducted from the CmsMart Admin account.</li>\n                </ul>\n\n                <p>Please ensure that all tickets are properly managed and closed within the specified time frame.</p>\n\n                <p>Thank you for your attention to this matter.</p>\n                <p>Here are the links to the tickets you need to close:</p>\n\n                <table width=\"100%\" cellpadding=\"5\" cellspacing=\"0\" style=\"border-collapse: collapse;\">\n                    <tr>\n                        <th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Ticket ID</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Subject</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Client</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Status</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Type</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Project</th>\n<th style=\"border-bottom: 1px solid #ddd; text-align: left;\">Agent</th>\n                      \n                    </tr>\n\n               {{ $json[\"data\"].map(item => `\n                <tr>\n                    <td style=\"border-bottom: 1px solid #ddd; padding: 8px;\"><a href=\"https://worksuite.cloodo.com/apps/tickets/all-tickets/${item.idTicket}\" style=\"color: #007bff; text-decoration: none;\">Ticket${item.numberTicket}</a></td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.subjectTicket}</td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.nameClient}</td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.statusTicket}</td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.typeTicket}</td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.projectTicket}</td>\n<td style=\"border-bottom: 1px solid #ddd; padding: 8px;\">${item.agentName}</td>\n                </tr>\n                `).join('') }}\n                \n\n                </table>\n\n                <p>Best regards,</p>\n                <p>Cms Admin</p>\n            </td>\n        </tr>\n    </table>\n</body>\n\n</html>\n"
            }
          ]
        },
        "options": {}
      },
      "id": "b69ba039-5390-4d9c-86af-6729fd2cac93",
      "name": "Send mail closed ticket8",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        6320,
        3820
      ]
    },
    {
      "parameters": {
        "fieldToSplitOut": "data",
        "options": {}
      },
      "id": "6cbb2d35-4c20-46a7-b4e3-1cb83a2e6547",
      "name": "Item Lists4",
      "type": "n8n-nodes-base.itemLists",
      "typeVersion": 3,
      "position": [
        780,
        5640
      ]
    },
    {
      "parameters": {
        "url": "https://erp-amz.cloodo.com/v4/tickets",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "cloodoApi",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "limit",
              "value": "100"
            },
            {
              "name": "date_from",
              "value": "2025-01-01"
            },
            {
              "name": "date_to",
              "value": "={{ $now.toDateTime() }}"
            },
            {
              "name": "sort",
              "value": "desc"
            },
            {
              "name": "status",
              "value": "pending"
            },
            {
              "name": "cursor",
              "value": "={{ $json.meta.next_cursor }}"
            }
          ]
        },
        "options": {}
      },
      "id": "b2416a4c-a87d-46de-9d4f-bd299cfea472",
      "name": "Ticket Pending4",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        480,
        5640
      ],
      "credentials": {
        "cloodoApi": {
          "id": "nP7U7wKTbfdSeafq",
          "name": "Cmsmart Worksuite account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $json.meta.next_cursor }}",
              "operation": "isNotEmpty"
            }
          ]
        }
      },
      "id": "ca4635b7-22f0-40b4-b23a-e16a5c665d80",
      "name": "IF8",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        680,
        5820
      ]
    },
    {
      "parameters": {
        "url": "=https://erp-amz.cloodo.com/v4/tickets/{{ $json.data.id }}/replies",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "cloodoApi",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "limit",
              "value": "10"
            }
          ]
        },
        "options": {}
      },
      "id": "3c825e3d-ce0d-4fef-ac28-4733e08fd3aa",
      "name": "Get replies4",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1300,
        5640
      ],
      "credentials": {
        "cloodoApi": {
          "id": "nP7U7wKTbfdSeafq",
          "name": "Cmsmart Worksuite account"
        }
      }
    },
    {
      "parameters": {
        "resource": "engagement",
        "ID": "={{ $json.id }}",
        "requestOptions": {}
      },
      "id": "35e4c718-772d-4cda-bec8-94095536e48a",
      "name": "Get Ticket4",
      "type": "@cloodo/n8n-nodes-cloodo-crm.CloodoLeads",
      "typeVersion": 1,
      "position": [
        1040,
        5640
      ],
      "credentials": {
        "cloodoApi": {
          "id": "nP7U7wKTbfdSeafq",
          "name": "Cmsmart Worksuite account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "796ab7b7-b19f-4a08-938e-16c2e40a9325",
              "name": "replies",
              "value": "={{ $json.data }}",
              "type": "array"
            },
            {
              "id": "377ffdcb-97b2-4ab7-b211-3376a7437855",
              "name": "ticket",
              "value": "={{ $('Get Ticket4').item.json.data }}",
              "type": "object"
            }
          ]
        },
        "options": {}
      },
      "id": "65567b82-b204-459d-b773-051d90837ca3",
      "name": "Replies and Ticket4",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1540,
        5640
      ]
    },
    {
      "parameters": {
        "fieldToSplitOut": "data",
        "options": {}
      },
      "id": "47eab7d4-e764-49a8-b7bc-bbbaf68c68bc",
      "name": "Item Lists5",
      "type": "n8n-nodes-base.itemLists",
      "typeVersion": 3,
      "position": [
        700,
        6380
      ]
    },
    {
      "parameters": {
        "url": "https://erp-amz.cloodo.com/v4/tickets",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "cloodoApi",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "limit",
              "value": "100"
            },
            {
              "name": "date_from",
              "value": "2025-01-01"
            },
            {
              "name": "date_to",
              "value": "={{ $now.toDateTime() }}"
            },
            {
              "name": "sort",
              "value": "desc"
            },
            {
              "name": "status",
              "value": "pending"
            },
            {
              "name": "cursor",
              "value": "={{ $json.meta.next_cursor }}"
            }
          ]
        },
        "options": {}
      },
      "id": "dc5715ed-2901-424f-9839-866286487bd4",
      "name": "Ticket Pending5",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        440,
        6380
      ],
      "credentials": {
        "cloodoApi": {
          "id": "nP7U7wKTbfdSeafq",
          "name": "Cmsmart Worksuite account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $json.meta.next_cursor }}",
              "operation": "isNotEmpty"
            }
          ]
        }
      },
      "id": "71b38516-e343-42c1-908f-590dd35d1ad1",
      "name": "IF2",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        640,
        6560
      ]
    },
    {
      "parameters": {
        "url": "=https://erp-amz.cloodo.com/v4/tickets/{{ $json.data.id }}/replies",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "cloodoApi",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "limit",
              "value": "10"
            }
          ]
        },
        "options": {}
      },
      "id": "85dbb46b-e5ed-4a2f-8740-c6f2501fd4fa",
      "name": "Get replies5",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1200,
        6380
      ],
      "credentials": {
        "cloodoApi": {
          "id": "nP7U7wKTbfdSeafq",
          "name": "Cmsmart Worksuite account"
        }
      }
    },
    {
      "parameters": {
        "resource": "engagement",
        "ID": "={{ $json.id }}",
        "requestOptions": {}
      },
      "id": "e267dc70-49d2-408f-98ff-bef62bd06080",
      "name": "Get Ticket5",
      "type": "@cloodo/n8n-nodes-cloodo-crm.CloodoLeads",
      "typeVersion": 1,
      "position": [
        960,
        6380
      ],
      "credentials": {
        "cloodoApi": {
          "id": "nP7U7wKTbfdSeafq",
          "name": "Cmsmart Worksuite account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "796ab7b7-b19f-4a08-938e-16c2e40a9325",
              "name": "replies",
              "value": "={{ $json.data }}",
              "type": "array"
            },
            {
              "id": "377ffdcb-97b2-4ab7-b211-3376a7437855",
              "name": "ticket",
              "value": "={{ $('Get Ticket5').item.json.data }}",
              "type": "object"
            }
          ]
        },
        "options": {}
      },
      "id": "88ca1517-ace3-4eca-9f50-b61f16fb6182",
      "name": "Replies and Ticket5",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1460,
        6380
      ]
    },
    {
      "parameters": {
        "jsCode": "const currentDate = new Date();  // Ngày hiện tại\nconst daysLimit = 24;  // Số ngày bạn muốn so sánh\nconst filteredItems = [];\n\n// Lặp qua từng item trong $input.all() và kiểm tra update_at\nfor (const item of $input.all()) {\n  const updateDate = new Date(item?.json?.replies[0]?.updated_at);  // Ngày cập nhật của item\n  const diffTime = currentDate - updateDate; // Tính sự khác biệt giữa ngày hiện tại và ngày update_at\n  const diffDays = diffTime / (1000 * 3600); // Chuyển từ milliseconds sang ngày\n  const idTicket = item?.json?.ticket?.id\n  const idClient = item?.json?.ticket?.requester?.id\n  const clientTicket = item?.json?.ticket?.requester?.name\n  const numberTicket = item?.json?.ticket?.ticket_number\n  const subjectTicket = item?.json?.ticket?.subject\n  const statusTicket = item?.json?.ticket?.status\n  const typeTicket = item?.json?.ticket?.type?.type\n  const projectTicket = item?.json?.ticket?.projects?.name\n  const agentNameTicket = item?.json?.ticket?.agent?.user?.name\n  const agentEmailTicket = item?.json?.ticket?.agent?.user?.email\n  const agentId = item?.json?.ticket?.agent?.user?.id\n  \n  if (diffDays > daysLimit) {\n    item.json.ticket = {idTicket: idTicket,\n                        idClient: idClient,\n                        nameClient: clientTicket,\n                        numberTicket: numberTicket,\n                        subjectTicket: subjectTicket,\n                        statusTicket: statusTicket,\n                        typeTicket: typeTicket,\n                        projectTicket: projectTicket,\n                        agentName: agentNameTicket,\n                        agentEmail: agentEmailTicket,\n                        agentId: agentId\n                       }\n    filteredItems.push(item);  // Thêm item vào danh sách nếu update_at sau 15 ngày\n  }\n}\n\nreturn filteredItems;  // Trả về các item thỏa mãn điều kiện\n"
      },
      "id": "af41e08a-9715-4466-a88a-b6fc70e8b5cf",
      "name": "Ticket 24h2",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1700,
        6380
      ]
    },
    {
      "parameters": {
        "fieldToSplitOut": "data",
        "options": {}
      },
      "id": "3dab7290-6b0b-477d-9bc5-62ad7477f089",
      "name": "Item Lists6",
      "type": "n8n-nodes-base.itemLists",
      "typeVersion": 3,
      "position": [
        760,
        7080
      ]
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $json.meta.next_cursor }}",
              "operation": "isNotEmpty"
            }
          ]
        }
      },
      "id": "7d93219d-3df6-417f-8d32-b2faae587308",
      "name": "IF9",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        660,
        7360
      ]
    },
    {
      "parameters": {
        "url": "=https://erp-amz.cloodo.com/v4/tickets/{{ $json.data.id }}/replies",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "cloodoApi",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "limit",
              "value": "10"
            }
          ]
        },
        "options": {}
      },
      "id": "50b3eef8-29a9-43c6-83f5-be8003e47b4d",
      "name": "Get replies6",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1520,
        7060
      ],
      "credentials": {
        "cloodoApi": {
          "id": "nP7U7wKTbfdSeafq",
          "name": "Cmsmart Worksuite account"
        }
      }
    },
    {
      "parameters": {
        "resource": "engagement",
        "ID": "={{ $json.id }}",
        "requestOptions": {}
      },
      "id": "d3f3b309-b02a-434d-ae6d-ea48195a1f4a",
      "name": "Get Ticket6",
      "type": "@cloodo/n8n-nodes-cloodo-crm.CloodoLeads",
      "typeVersion": 1,
      "position": [
        1000,
        7080
      ],
      "executeOnce": false,
      "credentials": {
        "cloodoApi": {
          "id": "nP7U7wKTbfdSeafq",
          "name": "Cmsmart Worksuite account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "796ab7b7-b19f-4a08-938e-16c2e40a9325",
              "name": "replies",
              "value": "={{ $json.data }}",
              "type": "array"
            },
            {
              "id": "377ffdcb-97b2-4ab7-b211-3376a7437855",
              "name": "ticket",
              "value": "={{ $('Get Ticket6').item.json.data }}",
              "type": "object"
            }
          ]
        },
        "options": {}
      },
      "id": "7d42f713-b97c-44be-821e-98cfd927e791",
      "name": "Replies and Ticket6",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1760,
        7060
      ]
    },
    {
      "parameters": {
        "fieldToSplitOut": "data",
        "options": {}
      },
      "id": "b266101e-df05-4241-b3ce-1c20eddf9c60",
      "name": "Item Lists7",
      "type": "n8n-nodes-base.itemLists",
      "typeVersion": 3,
      "position": [
        880,
        7880
      ]
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $json.meta.next_cursor }}",
              "operation": "isNotEmpty"
            }
          ]
        }
      },
      "id": "176a18bb-7e24-4c33-9038-c2bb5da96cfb",
      "name": "IF3",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        720,
        8200
      ]
    },
    {
      "parameters": {
        "url": "=https://erp-amz.cloodo.com/v4/tickets/{{ $json.data.id }}/replies",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "cloodoApi",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "limit",
              "value": "10"
            }
          ]
        },
        "options": {}
      },
      "id": "3d45e8a6-8a83-4b74-9115-bb5a9a9dece8",
      "name": "Get replies7",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1680,
        7860
      ],
      "credentials": {
        "cloodoApi": {
          "id": "nP7U7wKTbfdSeafq",
          "name": "Cmsmart Worksuite account"
        }
      }
    },
    {
      "parameters": {
        "resource": "engagement",
        "ID": "={{ $json.id }}",
        "requestOptions": {}
      },
      "id": "1c727200-1e64-4a71-8da3-4270876818e8",
      "name": "Get Ticket7",
      "type": "@cloodo/n8n-nodes-cloodo-crm.CloodoLeads",
      "typeVersion": 1,
      "position": [
        1140,
        7880
      ],
      "executeOnce": true,
      "credentials": {
        "cloodoApi": {
          "id": "nP7U7wKTbfdSeafq",
          "name": "Cmsmart Worksuite account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "796ab7b7-b19f-4a08-938e-16c2e40a9325",
              "name": "replies",
              "value": "={{ $json.data }}",
              "type": "array"
            },
            {
              "id": "377ffdcb-97b2-4ab7-b211-3376a7437855",
              "name": "ticket",
              "value": "={{ $('Get Ticket7').item.json.data }}",
              "type": "object"
            }
          ]
        },
        "options": {}
      },
      "id": "ea9e0e15-0819-4e74-81d3-6ac4d5eda310",
      "name": "Replies and Ticket7",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1900,
        7860
      ]
    },
    {
      "parameters": {
        "jsCode": "const currentDate = new Date();  // Ngày hiện tại\nconst daysLimit = 24;  // Số ngày bạn muốn so sánh\nconst filteredItems = [];\n\n// Lặp qua từng item trong $input.all() và kiểm tra update_at\nfor (const item of $input.all()) {\n  const updateDate = new Date(item?.json?.replies[0]?.created_at);  // Ngày cập nhật của item\n  const diffTime = currentDate - updateDate; // Tính sự khác biệt giữa ngày hiện tại và ngày update_at\n  const diffDays = diffTime / (1000 * 3600); // Chuyển từ milliseconds sang ngày\n  const idTicket = item?.json?.ticket?.id\n  const idClient = item?.json?.ticket?.requester?.id\n  const clientTicket = item?.json?.ticket?.requester?.name\n  const numberTicket = item?.json?.ticket?.ticket_number\n  const subjectTicket = item?.json?.ticket?.subject\n  const statusTicket = item?.json?.ticket?.status\n  const typeTicket = item?.json?.ticket?.type?.type\n  const projectTicket = item?.json?.ticket?.projects?.name\n  const agentNameTicket = item?.json?.ticket?.agent?.user?.name\n  const agentEmailTicket = item?.json?.ticket?.agent?.user?.email\n  const agentId = item?.json?.ticket?.agent?.user?.id\n  \n  if (diffDays > daysLimit) {\n    item.json.ticket = {idTicket: idTicket,\n                        idClient: idClient,\n                        nameClient: clientTicket,\n                        numberTicket: numberTicket,\n                        subjectTicket: subjectTicket,\n                        statusTicket: statusTicket,\n                        typeTicket: typeTicket,\n                        projectTicket: projectTicket,\n                        agentName: agentNameTicket,\n                        agentEmail: agentEmailTicket,\n                        agentId: agentId\n                       }\n    filteredItems.push(item);  // Thêm item vào danh sách nếu update_at sau 15 ngày\n  }\n}\n\nreturn filteredItems;  // Trả về các item thỏa mãn điều kiện\n"
      },
      "id": "616ff4a5-1d73-419d-8013-d17f6e01b47d",
      "name": "Ticket 24h3",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2120,
        7860
      ]
    },
    {
      "parameters": {
        "operation": "minus",
        "user_id": "={{ $('Ticket 8h').item.json.ticket.agentId }}",
        "points": "={{ $('Cloodo Point5')?.item?.json?.data.length > 0 ? Math.min(...$('Cloodo Point5')?.item?.json?.data?.map(item => item?.point)?.map(Number)) * -1 + 5 : 5  }}",
        "note": "=QCM 83-84: {{ $('Ticket 8h').item.json.ticket.agentName }} -{{ $('Cloodo Point5')?.item?.json?.data.length > 0 ? Math.min(...$('Cloodo Point5')?.item?.json?.data?.map(item => item?.point)?.map(Number)) * -1 + 5 : 5  }} points Ticket no closed or Ticket no reply Client: https://worksuite.cloodo.com/apps/tickets/all-tickets/{{ $('Ticket 8h').item.json.ticket.idTicket }}"
      },
      "id": "da95b2b3-8f0e-45ef-8239-8ca86156a391",
      "name": "Cloodo Point4",
      "type": "@cloodo/n8n-nodes-cloodo-point.cloodoPoint",
      "typeVersion": 1,
      "position": [
        3260,
        7060
      ],
      "credentials": {
        "cloodoApi2": {
          "id": "82nsSr6jMyGAQbyu",
          "name": "Cmsmart Point API Key"
        }
      }
    },
    {
      "parameters": {
        "operation": "search",
        "keyword": "=https://worksuite.cloodo.com/apps/tickets/all-tickets/{{ $('Ticket 8h').item.json.ticket.idTicket }}",
        "max_limit_record": 50,
        "status_record": -1
      },
      "id": "d5102a2d-ec44-4aa2-a3cb-632676218dbf",
      "name": "Cloodo Point5",
      "type": "@cloodo/n8n-nodes-cloodo-point.cloodoPoint",
      "typeVersion": 1,
      "position": [
        2960,
        7060
      ],
      "credentials": {
        "cloodoApi2": {
          "id": "82nsSr6jMyGAQbyu",
          "name": "Cmsmart Point API Key"
        }
      }
    },
    {
      "parameters": {
        "operation": "minus",
        "user_id": "={{ $('Ticket 24h3').item.json.ticket.agentId }}",
        "points": "={{ Math.min(...$('Cloodo Point7').item.json.data?.map(item => item?.point).map(Number)) * -1 }}",
        "note": "=QCM 83-84: {{ $('Ticket 24h3').item.json.ticket.agentName }} -{{ Math.min(...$('Cloodo Point7').item.json.data?.map(item => item?.point).map(Number)) * -1 }} points Ticket no closed or Ticket no reply Client: https://worksuite.cloodo.com/apps/tickets/all-tickets/{{ $('Ticket 24h3').item.json.ticket.idTicket }}"
      },
      "id": "2a29a133-ba02-44bb-b65e-07515427787a",
      "name": "Cloodo Point6",
      "type": "@cloodo/n8n-nodes-cloodo-point.cloodoPoint",
      "typeVersion": 1,
      "position": [
        3260,
        7860
      ],
      "credentials": {
        "cloodoApi2": {
          "id": "82nsSr6jMyGAQbyu",
          "name": "Cmsmart Point API Key"
        }
      }
    },
    {
      "parameters": {
        "operation": "search",
        "keyword": "=https://worksuite.cloodo.com/apps/tickets/all-tickets/{{ $('Ticket 24h3').item.json.ticket.idTicket }}",
        "max_limit_record": 50,
        "status_record": 0
      },
      "id": "a71118ff-9887-4354-9538-89c6db7d0a6d",
      "name": "Cloodo Point7",
      "type": "@cloodo/n8n-nodes-cloodo-point.cloodoPoint",
      "typeVersion": 1,
      "position": [
        2960,
        7860
      ],
      "credentials": {
        "cloodoApi2": {
          "id": "82nsSr6jMyGAQbyu",
          "name": "Cmsmart Point API Key"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const currentDate = new Date();  // Ngày hiện tại\nconst daysLimit = 8;  // Số ngày bạn muốn so sánh\nconst filteredItems = [];\n\n// Lặp qua từng item trong $input.all() và kiểm tra update_at\nfor (const item of $input.all()) {\n  const updateDate = new Date(item?.json?.replies[0]?.created_at);  // Ngày cập nhật của item\n  const diffTime = currentDate - updateDate; // Tính sự khác biệt giữa ngày hiện tại và ngày update_at\n  const diffDays = diffTime / (1000 * 3600); // Chuyển từ milliseconds sang ngày\n  const idTicket = item?.json?.ticket?.id\n  const idClient = item?.json?.ticket?.requester?.id\n  const clientTicket = item?.json?.ticket?.requester?.name\n  const numberTicket = item?.json?.ticket?.ticket_number\n  const subjectTicket = item?.json?.ticket?.subject\n  const statusTicket = item?.json?.ticket?.status\n  const typeTicket = item?.json?.ticket?.type?.type\n  const projectTicket = item?.json?.ticket?.projects?.name\n  const agentNameTicket = item?.json?.ticket?.agent?.user?.name\n  const agentEmailTicket = item?.json?.ticket?.agent?.user?.email\n  const agentId = item?.json?.ticket?.agent?.user?.id\n  \n  if (diffDays > daysLimit) {\n    item.json.ticket = {idTicket: idTicket,\n                        idClient: idClient,\n                        nameClient: clientTicket,\n                        numberTicket: numberTicket,\n                        subjectTicket: subjectTicket,\n                        statusTicket: statusTicket,\n                        typeTicket: typeTicket,\n                        projectTicket: projectTicket,\n                        agentName: agentNameTicket,\n                        agentEmail: agentEmailTicket,\n                        agentId: agentId\n                       }\n    filteredItems.push(item);  // Thêm item vào danh sách nếu update_at sau 15 ngày\n  }\n}\n\nreturn filteredItems;  // Trả về các item thỏa mãn điều kiện\n"
      },
      "id": "4191e362-40f7-415e-bb6f-2de0b4654ccb",
      "name": "Ticket 8h",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2000,
        7060
      ],
      "executeOnce": true
    },
    {
      "parameters": {
        "conditions": {
          "number": [
            {
              "value1": "={{ $json.total_records }}",
              "operation": "equal"
            }
          ]
        }
      },
      "id": "3023550d-cce4-4d67-9435-61d9a8a9f177",
      "name": "IF not found3",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        3140,
        7440
      ]
    },
    {
      "parameters": {
        "url": "https://erp-amz.cloodo.com/v4/tickets",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "cloodoApi",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "limit",
              "value": "100"
            },
            {
              "name": "date_from",
              "value": "2025-01-01"
            },
            {
              "name": "date_to",
              "value": "={{ $now.toDateTime() }}"
            },
            {
              "name": "sort",
              "value": "desc"
            },
            {
              "name": "status",
              "value": "open"
            },
            {
              "name": "cursor",
              "value": "={{ $json.meta.next_cursor }}"
            }
          ]
        },
        "options": {}
      },
      "id": "7c7980c8-0c19-49e5-9c20-6998ca9dc96c",
      "name": "Ticket Open",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        580,
        7880
      ],
      "credentials": {
        "cloodoApi": {
          "id": "nP7U7wKTbfdSeafq",
          "name": "Cmsmart Worksuite account"
        }
      }
    },
    {
      "parameters": {
        "url": "https://erp-amz.cloodo.com/v4/tickets",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "cloodoApi",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "limit",
              "value": "100"
            },
            {
              "name": "date_from",
              "value": "2025-01-01"
            },
            {
              "name": "date_to",
              "value": "={{ $now.toDateTime() }}"
            },
            {
              "name": "sort",
              "value": "desc"
            },
            {
              "name": "status",
              "value": "open"
            },
            {
              "name": "cursor",
              "value": "={{ $json.meta.next_cursor }}"
            }
          ]
        },
        "options": {}
      },
      "id": "50e3e871-6811-435b-aaa5-f45842984291",
      "name": "Ticket Open1",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        460,
        7080
      ],
      "credentials": {
        "cloodoApi": {
          "id": "nP7U7wKTbfdSeafq",
          "name": "Cmsmart Worksuite account"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "id": "c83541b9-9d7f-4e58-ba05-492763ee5a3b",
      "name": "Loop Over Items",
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        2640,
        7040
      ]
    },
    {
      "parameters": {
        "options": {}
      },
      "id": "3fabb274-2ab7-4703-a0bf-895dd735c11a",
      "name": "Loop Over Items1",
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        2700,
        7840
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "9ab35c59-58f9-43a8-8026-b499641ff4cd",
              "leftValue": "={{ $json.data.requester.email }}",
              "rightValue": "={{ $json.data.create_by.email }}",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "cd6f80f1-b125-46e5-9ffa-40e09c5c2238",
      "name": "Check client send",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        1220,
        7080
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "6dc6657f-526c-4633-a42e-591e9f2e964d",
              "leftValue": "={{ $json.replies[0].user.id }}",
              "rightValue": "={{ $json.ticket.idClient }}",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "5a58cf85-b95b-47b3-8585-d23be474eab4",
      "name": "Requester Replies4",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        2240,
        7060
      ]
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "https://docs.google.com/spreadsheets/d/1lM_TG2ExLdbs1YoBcaFzBFscVqB3MOEFjBFnvE9kAa0/edit?gid=0#gid=0",
          "mode": "url"
        },
        "sheetName": {
          "__rl": true,
          "value": 1298489612,
          "mode": "list",
          "cachedResultName": "Phuong",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lM_TG2ExLdbs1YoBcaFzBFscVqB3MOEFjBFnvE9kAa0/edit#gid=1298489612"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "idTicket": "={{ $json.ticket.idTicket }}",
            "agenEmail": "={{ $json.ticket.agentEmail }}",
            "numberTicket": "={{ $json.ticket.numberTicket }}",
            "agentName": "={{ $json.ticket.agentName }}",
            "lastRespone": "Client",
            "nameClient": "={{ $json.ticket.nameClient }}",
            "typeTicket": "={{ $json.ticket.typeTicket }}",
            "subjectTicket": "={{ $json.ticket.subjectTicket }}",
            "statusTicket": "={{ $json.ticket.statusTicket }}",
            "projectTicket": "={{ $json.ticket.projectTicket }}"
          },
          "matchingColumns": [
            "idTicket"
          ],
          "schema": [
            {
              "id": "idTicket",
              "displayName": "idTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "numberTicket",
              "displayName": "numberTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "agentName",
              "displayName": "agentName",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "agenEmail",
              "displayName": "agenEmail",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "lastRespone",
              "displayName": "lastRespone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "nameClient",
              "displayName": "nameClient",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "subjectTicket",
              "displayName": "subjectTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "statusTicket",
              "displayName": "statusTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "typeTicket",
              "displayName": "typeTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "projectTicket",
              "displayName": "projectTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ]
        },
        "options": {}
      },
      "id": "5703debe-4726-410a-8da6-d977964dfff9",
      "name": "Phuong5",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        3880,
        4120
      ],
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "P5h6CdXmV7twphIt",
          "name": "Canh Google Sheets"
        }
      }
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "https://docs.google.com/spreadsheets/d/1lM_TG2ExLdbs1YoBcaFzBFscVqB3MOEFjBFnvE9kAa0/edit?gid=0#gid=0",
          "mode": "url"
        },
        "sheetName": {
          "__rl": true,
          "value": 2073353188,
          "mode": "list",
          "cachedResultName": "Chi",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lM_TG2ExLdbs1YoBcaFzBFscVqB3MOEFjBFnvE9kAa0/edit#gid=2073353188"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "idTicket": "={{ $json.ticket.idTicket }}",
            "numberTicket": "={{ $json.ticket.numberTicket }}",
            "agentName": "={{ $json.ticket.agentName }}",
            "agenEmail": "={{ $json.ticket.agentEmail }}",
            "lastRespone": "Client",
            "nameClient": "={{ $json.ticket.nameClient }}",
            "subjectTicket": "={{ $json.ticket.subjectTicket }}",
            "statusTicket": "={{ $json.ticket.statusTicket }}",
            "typeTicket": "={{ $json.ticket.typeTicket }}",
            "projectTicket": "={{ $json.ticket.projectTicket }}"
          },
          "matchingColumns": [
            "idTicket"
          ],
          "schema": [
            {
              "id": "idTicket",
              "displayName": "idTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "numberTicket",
              "displayName": "numberTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "agentName",
              "displayName": "agentName",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "agenEmail",
              "displayName": "agenEmail",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "lastRespone",
              "displayName": "lastRespone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "nameClient",
              "displayName": "nameClient",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "subjectTicket",
              "displayName": "subjectTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "statusTicket",
              "displayName": "statusTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "typeTicket",
              "displayName": "typeTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "projectTicket",
              "displayName": "projectTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ]
        },
        "options": {}
      },
      "id": "8c585ed6-aaf1-4da1-bfad-cb5960d54e99",
      "name": "Chi5",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        3880,
        4440
      ],
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "P5h6CdXmV7twphIt",
          "name": "Canh Google Sheets"
        }
      }
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "https://docs.google.com/spreadsheets/d/1lM_TG2ExLdbs1YoBcaFzBFscVqB3MOEFjBFnvE9kAa0/edit?gid=0#gid=0",
          "mode": "url"
        },
        "sheetName": {
          "__rl": true,
          "value": 548962283,
          "mode": "list",
          "cachedResultName": "Chau",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lM_TG2ExLdbs1YoBcaFzBFscVqB3MOEFjBFnvE9kAa0/edit#gid=548962283"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "idTicket": "={{ $json.ticket.idTicket }}",
            "numberTicket": "={{ $json.ticket.numberTicket }}",
            "agentName": "={{ $json.ticket.agentName }}",
            "agenEmail": "={{ $json.ticket.agentEmail }}",
            "lastRespone": "Client",
            "nameClient": "={{ $json.ticket.nameClient }}",
            "subjectTicket": "={{ $json.ticket.subjectTicket }}",
            "statusTicket": "={{ $json.ticket.statusTicket }}",
            "typeTicket": "={{ $json.ticket.typeTicket }}",
            "projectTicket": "={{ $json.ticket.projectTicket }}"
          },
          "matchingColumns": [
            "idTicket"
          ],
          "schema": [
            {
              "id": "idTicket",
              "displayName": "idTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "numberTicket",
              "displayName": "numberTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "agentName",
              "displayName": "agentName",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "agenEmail",
              "displayName": "agenEmail",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "lastRespone",
              "displayName": "lastRespone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "nameClient",
              "displayName": "nameClient",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "subjectTicket",
              "displayName": "subjectTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "statusTicket",
              "displayName": "statusTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "typeTicket",
              "displayName": "typeTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "projectTicket",
              "displayName": "projectTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ]
        },
        "options": {}
      },
      "id": "75c5f586-fe15-40b2-96f3-63e389782ffa",
      "name": "Chau5",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        3860,
        4640
      ],
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "P5h6CdXmV7twphIt",
          "name": "Canh Google Sheets"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "9ab35c59-58f9-43a8-8026-b499641ff4cd",
              "leftValue": "={{ $json.data.requester.email }}",
              "rightValue": "={{ $json.data.create_by.email }}",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "9afee8c0-59f6-462b-8820-46133cab6297",
      "name": "Check client send1",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        1400,
        7880
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "6dc6657f-526c-4633-a42e-591e9f2e964d",
              "leftValue": "={{ $json.replies[0].user.id }}",
              "rightValue": "={{ $json.ticket.idClient }}",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "13450a0e-017c-43f6-8d09-57accccb3771",
      "name": "Requester Replies5",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        2380,
        7860
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "6dc6657f-526c-4633-a42e-591e9f2e964d",
              "leftValue": "={{ $json.replies[0].user.id }}",
              "rightValue": "={{ $json.ticket.idClient }}",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "efd31f61-c12b-492b-8ef8-13fe7a5b05bb",
      "name": "Requester Replies6",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        2040,
        5640
      ]
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "2a75c8aa-0ad9-4171-b215-7ddea1d07bd8",
                    "leftValue": "={{ $json.ticket.agentEmail }}",
                    "rightValue": "phuong.nt@netbasejsc.com",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Phuong"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "c01ba01c-39bd-41c7-82c6-cc9a876741d2",
                    "leftValue": "={{ $json.ticket.agentEmail }}",
                    "rightValue": "huy.nhd@netbasejsc.com",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Huy"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "7add08a8-dffe-44d7-b27c-73344547b865",
                    "leftValue": "={{ $json.ticket.agentEmail }}",
                    "rightValue": "chi.hu@netbasejsc.com",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Chi"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "1591f407-008f-43ca-b641-27b4d699617d",
                    "leftValue": "={{ $json.ticket.agentEmail }}",
                    "rightValue": "chau.lt@netbasejsc.com",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Chau"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "b33cb102-6f78-4a4d-9e88-5b2725a64274",
                    "leftValue": "={{ $json.ticket.agentEmail }}",
                    "rightValue": "",
                    "operator": {
                      "type": "string",
                      "operation": "notEmpty",
                      "singleValue": true
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "default"
            }
          ]
        },
        "options": {}
      },
      "id": "36f8f473-bab1-450f-a639-0ac2fd91cfad",
      "name": "Switch5",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        3420,
        3120
      ]
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "https://docs.google.com/spreadsheets/d/1lM_TG2ExLdbs1YoBcaFzBFscVqB3MOEFjBFnvE9kAa0/edit?gid=0#gid=0",
          "mode": "url"
        },
        "sheetName": {
          "__rl": true,
          "value": 1298489612,
          "mode": "list",
          "cachedResultName": "Phuong",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lM_TG2ExLdbs1YoBcaFzBFscVqB3MOEFjBFnvE9kAa0/edit#gid=1298489612"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "idTicket": "={{ $json.ticket.idTicket }}",
            "agenEmail": "={{ $json.ticket.agentEmail }}",
            "numberTicket": "={{ $json.ticket.numberTicket }}",
            "agentName": "={{ $json.ticket.agentName }}",
            "lastRespone": "Client",
            "nameClient": "={{ $json.ticket.nameClient }}",
            "typeTicket": "={{ $json.ticket.typeTicket }}",
            "subjectTicket": "={{ $json.ticket.subjectTicket }}",
            "statusTicket": "={{ $json.ticket.statusTicket }}",
            "projectTicket": "={{ $json.ticket.projectTicket }}"
          },
          "matchingColumns": [
            "idTicket"
          ],
          "schema": [
            {
              "id": "idTicket",
              "displayName": "idTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "numberTicket",
              "displayName": "numberTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "agentName",
              "displayName": "agentName",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "agenEmail",
              "displayName": "agenEmail",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "lastRespone",
              "displayName": "lastRespone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "nameClient",
              "displayName": "nameClient",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "subjectTicket",
              "displayName": "subjectTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "statusTicket",
              "displayName": "statusTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "typeTicket",
              "displayName": "typeTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "projectTicket",
              "displayName": "projectTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ]
        },
        "options": {}
      },
      "id": "553ae6a6-5100-4ddc-80b2-52d649e56d6d",
      "name": "Phuong6",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        3740,
        2940
      ],
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "P5h6CdXmV7twphIt",
          "name": "Canh Google Sheets"
        }
      }
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "https://docs.google.com/spreadsheets/d/1lM_TG2ExLdbs1YoBcaFzBFscVqB3MOEFjBFnvE9kAa0/edit?gid=0#gid=0",
          "mode": "url"
        },
        "sheetName": {
          "__rl": true,
          "value": 2073353188,
          "mode": "list",
          "cachedResultName": "Chi",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lM_TG2ExLdbs1YoBcaFzBFscVqB3MOEFjBFnvE9kAa0/edit#gid=2073353188"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "idTicket": "={{ $json.ticket.idTicket }}",
            "numberTicket": "={{ $json.ticket.numberTicket }}",
            "agentName": "={{ $json.ticket.agentName }}",
            "agenEmail": "={{ $json.ticket.agentEmail }}",
            "lastRespone": "Client",
            "nameClient": "={{ $json.ticket.nameClient }}",
            "subjectTicket": "={{ $json.ticket.subjectTicket }}",
            "statusTicket": "={{ $json.ticket.statusTicket }}",
            "typeTicket": "={{ $json.ticket.typeTicket }}",
            "projectTicket": "={{ $json.ticket.projectTicket }}"
          },
          "matchingColumns": [
            "idTicket"
          ],
          "schema": [
            {
              "id": "idTicket",
              "displayName": "idTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "numberTicket",
              "displayName": "numberTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "agentName",
              "displayName": "agentName",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "agenEmail",
              "displayName": "agenEmail",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "lastRespone",
              "displayName": "lastRespone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "nameClient",
              "displayName": "nameClient",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "subjectTicket",
              "displayName": "subjectTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "statusTicket",
              "displayName": "statusTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "typeTicket",
              "displayName": "typeTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "projectTicket",
              "displayName": "projectTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ]
        },
        "options": {}
      },
      "id": "131af947-78d0-494f-8138-5639308aa903",
      "name": "Chi6",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        3780,
        3160
      ],
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "P5h6CdXmV7twphIt",
          "name": "Canh Google Sheets"
        }
      }
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "https://docs.google.com/spreadsheets/d/1lM_TG2ExLdbs1YoBcaFzBFscVqB3MOEFjBFnvE9kAa0/edit?gid=0#gid=0",
          "mode": "url"
        },
        "sheetName": {
          "__rl": true,
          "value": 548962283,
          "mode": "list",
          "cachedResultName": "Chau",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lM_TG2ExLdbs1YoBcaFzBFscVqB3MOEFjBFnvE9kAa0/edit#gid=548962283"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "idTicket": "={{ $json.ticket.idTicket }}",
            "numberTicket": "={{ $json.ticket.numberTicket }}",
            "agentName": "={{ $json.ticket.agentName }}",
            "agenEmail": "={{ $json.ticket.agentEmail }}",
            "lastRespone": "Client",
            "nameClient": "={{ $json.ticket.nameClient }}",
            "subjectTicket": "={{ $json.ticket.subjectTicket }}",
            "statusTicket": "={{ $json.ticket.statusTicket }}",
            "typeTicket": "={{ $json.ticket.typeTicket }}",
            "projectTicket": "={{ $json.ticket.projectTicket }}"
          },
          "matchingColumns": [
            "idTicket"
          ],
          "schema": [
            {
              "id": "idTicket",
              "displayName": "idTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "numberTicket",
              "displayName": "numberTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "agentName",
              "displayName": "agentName",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "agenEmail",
              "displayName": "agenEmail",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "lastRespone",
              "displayName": "lastRespone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "nameClient",
              "displayName": "nameClient",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "subjectTicket",
              "displayName": "subjectTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "statusTicket",
              "displayName": "statusTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "typeTicket",
              "displayName": "typeTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "projectTicket",
              "displayName": "projectTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ]
        },
        "options": {}
      },
      "id": "8857b934-d312-4fac-95f2-0c9ca3158415",
      "name": "Chau6",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        3760,
        3360
      ],
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "P5h6CdXmV7twphIt",
          "name": "Canh Google Sheets"
        }
      }
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "https://docs.google.com/spreadsheets/d/1lM_TG2ExLdbs1YoBcaFzBFscVqB3MOEFjBFnvE9kAa0/edit?gid=0#gid=0",
          "mode": "url"
        },
        "sheetName": {
          "__rl": true,
          "value": 1298489612,
          "mode": "list",
          "cachedResultName": "Phuong",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lM_TG2ExLdbs1YoBcaFzBFscVqB3MOEFjBFnvE9kAa0/edit#gid=1298489612"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "idTicket": "={{ $json.ticket.idTicket }}",
            "agenEmail": "={{ $json.ticket.agentEmail }}",
            "numberTicket": "={{ $json.ticket.numberTicket }}",
            "agentName": "={{ $json.ticket.agentName }}",
            "nameClient": "={{ $json.ticket.nameClient }}",
            "typeTicket": "={{ $json.ticket.typeTicket }}",
            "subjectTicket": "={{ $json.ticket.subjectTicket }}",
            "statusTicket": "={{ $json.ticket.statusTicket }}",
            "projectTicket": "={{ $json.ticket.projectTicket }}",
            "lastRespone": "Agent"
          },
          "matchingColumns": [
            "idTicket"
          ],
          "schema": [
            {
              "id": "idTicket",
              "displayName": "idTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "numberTicket",
              "displayName": "numberTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "agentName",
              "displayName": "agentName",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "agenEmail",
              "displayName": "agenEmail",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "lastRespone",
              "displayName": "lastRespone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "nameClient",
              "displayName": "nameClient",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "subjectTicket",
              "displayName": "subjectTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "statusTicket",
              "displayName": "statusTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "typeTicket",
              "displayName": "typeTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "projectTicket",
              "displayName": "projectTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ]
        },
        "options": {}
      },
      "id": "3869c605-6eab-43cc-81a9-66c3496469a7",
      "name": "Phuong7",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        3900,
        3520
      ],
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "P5h6CdXmV7twphIt",
          "name": "Canh Google Sheets"
        }
      }
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "https://docs.google.com/spreadsheets/d/1lM_TG2ExLdbs1YoBcaFzBFscVqB3MOEFjBFnvE9kAa0/edit?gid=0#gid=0",
          "mode": "url"
        },
        "sheetName": {
          "__rl": true,
          "value": 548962283,
          "mode": "list",
          "cachedResultName": "Chau",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lM_TG2ExLdbs1YoBcaFzBFscVqB3MOEFjBFnvE9kAa0/edit#gid=548962283"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "idTicket": "={{ $json.ticket.idTicket }}",
            "numberTicket": "={{ $json.ticket.numberTicket }}",
            "agentName": "={{ $json.ticket.agentName }}",
            "agenEmail": "={{ $json.ticket.agentEmail }}",
            "nameClient": "={{ $json.ticket.nameClient }}",
            "subjectTicket": "={{ $json.ticket.subjectTicket }}",
            "statusTicket": "={{ $json.ticket.statusTicket }}",
            "typeTicket": "={{ $json.ticket.typeTicket }}",
            "projectTicket": "={{ $json.ticket.projectTicket }}",
            "lastRespone": "Agent"
          },
          "matchingColumns": [
            "idTicket"
          ],
          "schema": [
            {
              "id": "idTicket",
              "displayName": "idTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "numberTicket",
              "displayName": "numberTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "agentName",
              "displayName": "agentName",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "agenEmail",
              "displayName": "agenEmail",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "lastRespone",
              "displayName": "lastRespone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "nameClient",
              "displayName": "nameClient",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "subjectTicket",
              "displayName": "subjectTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "statusTicket",
              "displayName": "statusTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "typeTicket",
              "displayName": "typeTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "projectTicket",
              "displayName": "projectTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ]
        },
        "options": {}
      },
      "id": "27a019a4-c174-48e4-9ca8-f302b5fa9b28",
      "name": "Chau7",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        3900,
        3920
      ],
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "P5h6CdXmV7twphIt",
          "name": "Canh Google Sheets"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "2a75c8aa-0ad9-4171-b215-7ddea1d07bd8",
                    "leftValue": "={{ $json.ticket.agentEmail }}",
                    "rightValue": "phuong.nt@netbasejsc.com",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Phuong"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "c01ba01c-39bd-41c7-82c6-cc9a876741d2",
                    "leftValue": "={{ $json.ticket.agentEmail }}",
                    "rightValue": "huy.nhd@netbasejsc.com",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Huy"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "7add08a8-dffe-44d7-b27c-73344547b865",
                    "leftValue": "={{ $json.ticket.agentEmail }}",
                    "rightValue": "chi.hu@netbasejsc.com",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Chi"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "1591f407-008f-43ca-b641-27b4d699617d",
                    "leftValue": "={{ $json.ticket.agentEmail }}",
                    "rightValue": "chau.lt@netbasejsc.com",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Chau"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "b33cb102-6f78-4a4d-9e88-5b2725a64274",
                    "leftValue": "={{ $json.ticket.agentEmail }}",
                    "rightValue": "",
                    "operator": {
                      "type": "string",
                      "operation": "notEmpty",
                      "singleValue": true
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "default"
            }
          ]
        },
        "options": {}
      },
      "id": "17d927e1-e002-45f5-84dc-01a8ba51c362",
      "name": "Switch6",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        3560,
        3680
      ]
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "https://docs.google.com/spreadsheets/d/1lM_TG2ExLdbs1YoBcaFzBFscVqB3MOEFjBFnvE9kAa0/edit?gid=0#gid=0",
          "mode": "url"
        },
        "sheetName": {
          "__rl": true,
          "value": 1298489612,
          "mode": "list",
          "cachedResultName": "Phuong",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lM_TG2ExLdbs1YoBcaFzBFscVqB3MOEFjBFnvE9kAa0/edit#gid=1298489612"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "idTicket": "={{ $json.ticket.idTicket }}",
            "agenEmail": "={{ $json.ticket.agentEmail }}",
            "numberTicket": "={{ $json.ticket.numberTicket }}",
            "agentName": "={{ $json.ticket.agentName }}",
            "nameClient": "={{ $json.ticket.nameClient }}",
            "typeTicket": "={{ $json.ticket.typeTicket }}",
            "subjectTicket": "={{ $json.ticket.subjectTicket }}",
            "statusTicket": "={{ $json.ticket.statusTicket }}",
            "projectTicket": "={{ $json.ticket.projectTicket }}",
            "lastRespone": "Agent"
          },
          "matchingColumns": [
            "idTicket"
          ],
          "schema": [
            {
              "id": "idTicket",
              "displayName": "idTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "numberTicket",
              "displayName": "numberTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "agentName",
              "displayName": "agentName",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "agenEmail",
              "displayName": "agenEmail",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "lastRespone",
              "displayName": "lastRespone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "nameClient",
              "displayName": "nameClient",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "subjectTicket",
              "displayName": "subjectTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "statusTicket",
              "displayName": "statusTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "typeTicket",
              "displayName": "typeTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "projectTicket",
              "displayName": "projectTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ]
        },
        "options": {}
      },
      "id": "6c35914b-9748-4bf3-a7d1-58115773d31a",
      "name": "Phuong8",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        3640,
        4800
      ],
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "P5h6CdXmV7twphIt",
          "name": "Canh Google Sheets"
        }
      }
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "https://docs.google.com/spreadsheets/d/1lM_TG2ExLdbs1YoBcaFzBFscVqB3MOEFjBFnvE9kAa0/edit?gid=0#gid=0",
          "mode": "url"
        },
        "sheetName": {
          "__rl": true,
          "value": 2073353188,
          "mode": "list",
          "cachedResultName": "Chi",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lM_TG2ExLdbs1YoBcaFzBFscVqB3MOEFjBFnvE9kAa0/edit#gid=2073353188"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "idTicket": "={{ $json.ticket.idTicket }}",
            "numberTicket": "={{ $json.ticket.numberTicket }}",
            "agentName": "={{ $json.ticket.agentName }}",
            "agenEmail": "={{ $json.ticket.agentEmail }}",
            "nameClient": "={{ $json.ticket.nameClient }}",
            "subjectTicket": "={{ $json.ticket.subjectTicket }}",
            "statusTicket": "={{ $json.ticket.statusTicket }}",
            "typeTicket": "={{ $json.ticket.typeTicket }}",
            "projectTicket": "={{ $json.ticket.projectTicket }}",
            "lastRespone": "Agent"
          },
          "matchingColumns": [
            "idTicket"
          ],
          "schema": [
            {
              "id": "idTicket",
              "displayName": "idTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "numberTicket",
              "displayName": "numberTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "agentName",
              "displayName": "agentName",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "agenEmail",
              "displayName": "agenEmail",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "lastRespone",
              "displayName": "lastRespone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "nameClient",
              "displayName": "nameClient",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "subjectTicket",
              "displayName": "subjectTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "statusTicket",
              "displayName": "statusTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "typeTicket",
              "displayName": "typeTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "projectTicket",
              "displayName": "projectTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ]
        },
        "options": {}
      },
      "id": "5d2db9bf-6daa-4ee9-b019-580747654bdb",
      "name": "Chi8",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        3640,
        5000
      ],
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "P5h6CdXmV7twphIt",
          "name": "Canh Google Sheets"
        }
      }
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "https://docs.google.com/spreadsheets/d/1lM_TG2ExLdbs1YoBcaFzBFscVqB3MOEFjBFnvE9kAa0/edit?gid=0#gid=0",
          "mode": "url"
        },
        "sheetName": {
          "__rl": true,
          "value": 548962283,
          "mode": "list",
          "cachedResultName": "Chau",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lM_TG2ExLdbs1YoBcaFzBFscVqB3MOEFjBFnvE9kAa0/edit#gid=548962283"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "idTicket": "={{ $json.ticket.idTicket }}",
            "numberTicket": "={{ $json.ticket.numberTicket }}",
            "agentName": "={{ $json.ticket.agentName }}",
            "agenEmail": "={{ $json.ticket.agentEmail }}",
            "nameClient": "={{ $json.ticket.nameClient }}",
            "subjectTicket": "={{ $json.ticket.subjectTicket }}",
            "statusTicket": "={{ $json.ticket.statusTicket }}",
            "typeTicket": "={{ $json.ticket.typeTicket }}",
            "projectTicket": "={{ $json.ticket.projectTicket }}",
            "lastRespone": "Agent"
          },
          "matchingColumns": [
            "idTicket"
          ],
          "schema": [
            {
              "id": "idTicket",
              "displayName": "idTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "numberTicket",
              "displayName": "numberTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "agentName",
              "displayName": "agentName",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "agenEmail",
              "displayName": "agenEmail",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "lastRespone",
              "displayName": "lastRespone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "nameClient",
              "displayName": "nameClient",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "subjectTicket",
              "displayName": "subjectTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "statusTicket",
              "displayName": "statusTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "typeTicket",
              "displayName": "typeTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "projectTicket",
              "displayName": "projectTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ]
        },
        "options": {}
      },
      "id": "a060ed27-7531-4ad2-bec1-7ccbc3d10f1c",
      "name": "Chau8",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        3640,
        5200
      ],
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "P5h6CdXmV7twphIt",
          "name": "Canh Google Sheets"
        }
      }
    },
    {
      "parameters": {
        "url": "=https://erp-amz.cloodo.com/v4/tickets/{{ $json.data.id }}/replies",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "cloodoApi",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "limit",
              "value": "10"
            }
          ]
        },
        "options": {}
      },
      "id": "af7af6ca-a8da-4fb4-b49e-05846bb7fd08",
      "name": "Get replies8",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1400,
        7420
      ],
      "credentials": {
        "cloodoApi": {
          "id": "nP7U7wKTbfdSeafq",
          "name": "Cmsmart Worksuite account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "796ab7b7-b19f-4a08-938e-16c2e40a9325",
              "name": "replies",
              "value": "={{ $json.data }}",
              "type": "array"
            },
            {
              "id": "377ffdcb-97b2-4ab7-b211-3376a7437855",
              "name": "ticket",
              "value": "={{ $('Get Ticket6').item.json.data }}",
              "type": "object"
            }
          ]
        },
        "options": {}
      },
      "id": "b6a381d8-36d6-4ccf-8ad5-848fbb4b4c0f",
      "name": "Replies and Ticket8",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1640,
        7420
      ]
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "2a75c8aa-0ad9-4171-b215-7ddea1d07bd8",
                    "leftValue": "={{ $json.ticket.agentEmail }}",
                    "rightValue": "phuong.nt@netbasejsc.com",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Phuong"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "c01ba01c-39bd-41c7-82c6-cc9a876741d2",
                    "leftValue": "={{ $json.ticket.agentEmail }}",
                    "rightValue": "huy.nhd@netbasejsc.com",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Huy"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "7add08a8-dffe-44d7-b27c-73344547b865",
                    "leftValue": "={{ $json.ticket.agentEmail }}",
                    "rightValue": "chi.hu@netbasejsc.com",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Chi"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "1591f407-008f-43ca-b641-27b4d699617d",
                    "leftValue": "={{ $json.ticket.agentEmail }}",
                    "rightValue": "chau.lt@netbasejsc.com",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Chau"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "b33cb102-6f78-4a4d-9e88-5b2725a64274",
                    "leftValue": "={{ $json.ticket.agentEmail }}",
                    "rightValue": "",
                    "operator": {
                      "type": "string",
                      "operation": "notEmpty",
                      "singleValue": true
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "default"
            }
          ]
        },
        "options": {}
      },
      "id": "2d89e4ea-6794-40cd-ad38-44054ef9930c",
      "name": "Switch7",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        3300,
        4960
      ]
    },
    {
      "parameters": {
        "operation": "minus",
        "user_id": "={{ $('Ticket 15d').item.json.ticket.agentId }}",
        "points": "=5",
        "note": "=QCM 83-84: {{ $('Ticket 15d').item.json.ticket.agentName }} -5 points Ticket no closed or Ticket no reply Client: https://worksuite.cloodo.com/apps/tickets/all-tickets/{{ $('Ticket 15d').item.json.ticket.idTicket }}"
      },
      "id": "620f62a7-531f-4b6c-9b7a-e07081945f87",
      "name": "Cloodo Point9",
      "type": "@cloodo/n8n-nodes-cloodo-point.cloodoPoint",
      "typeVersion": 1,
      "position": [
        3420,
        7420
      ],
      "credentials": {
        "cloodoApi2": {
          "id": "82nsSr6jMyGAQbyu",
          "name": "Cmsmart Point API Key"
        }
      }
    },
    {
      "parameters": {
        "operation": "search",
        "keyword": "=QCM 83-84: {{ $('Ticket 15d').item.json.ticket.agentName }} -5 points Ticket no closed or Ticket no reply Client: https://worksuite.cloodo.com/apps/tickets/all-tickets/{{ $('Ticket 15d').item.json.ticket.idTicket }}",
        "max_limit_record": 50,
        "status_record": 0
      },
      "id": "99235c40-d08d-4319-9c8f-c32969d8793d",
      "name": "Cloodo Point10",
      "type": "@cloodo/n8n-nodes-cloodo-point.cloodoPoint",
      "typeVersion": 1,
      "position": [
        2940,
        7440
      ],
      "credentials": {
        "cloodoApi2": {
          "id": "82nsSr6jMyGAQbyu",
          "name": "Cmsmart Point API Key"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "id": "1a9122a4-87b1-4623-8692-2ab280076e90",
      "name": "Loop Over Items2",
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        2620,
        7420
      ]
    },
    {
      "parameters": {
        "jsCode": "const currentDate = new Date();  // Ngày hiện tại\nconst daysLimit = 15;  // Số ngày bạn muốn so sánh\nconst filteredItems = [];\n\n// Lặp qua từng item trong $input.all() và kiểm tra update_at\nfor (const item of $input.all()) {\n  const updateDate = new Date(item?.json?.replies[0]?.created_at);  // Ngày cập nhật của item\n  const diffTime = currentDate - updateDate; // Tính sự khác biệt giữa ngày hiện tại và ngày update_at\n  const diffDays = diffTime / (1000 * 3600 * 24); // Chuyển từ milliseconds sang ngày\n  const idTicket = item?.json?.ticket?.id\n  const idClient = item?.json?.ticket?.requester?.id\n  const clientTicket = item?.json?.ticket?.requester?.name\n  const numberTicket = item?.json?.ticket?.ticket_number\n  const subjectTicket = item?.json?.ticket?.subject\n  const statusTicket = item?.json?.ticket?.status\n  const typeTicket = item?.json?.ticket?.type?.type\n  const projectTicket = item?.json?.ticket?.projects?.name\n  const agentNameTicket = item?.json?.ticket?.agent?.user?.name\n  const agentEmailTicket = item?.json?.ticket?.agent?.user?.email\n  const agentId = item?.json?.ticket?.agent?.user?.id\n  \n  if (diffDays > daysLimit) {\n    item.json.ticket = {idTicket: idTicket,\n                        idClient: idClient,\n                        nameClient: clientTicket,\n                        numberTicket: numberTicket,\n                        subjectTicket: subjectTicket,\n                        statusTicket: statusTicket,\n                        typeTicket: typeTicket,\n                        projectTicket: projectTicket,\n                        agentName: agentNameTicket,\n                        agentEmail: agentEmailTicket,\n                        agentId: agentId\n                       }\n    filteredItems.push(item);  // Thêm item vào danh sách nếu update_at sau 15 ngày\n  }\n}\n\nreturn filteredItems;  // Trả về các item thỏa mãn điều kiện\n"
      },
      "id": "d1c0a6b4-22e5-4996-b47c-05073dc051f2",
      "name": "Ticket 15d",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1880,
        7420
      ],
      "executeOnce": true
    },
    {
      "parameters": {
        "url": "=https://erp-amz.cloodo.com/v4/tickets/{{ $json.data.id }}/replies",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "cloodoApi",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "limit",
              "value": "10"
            }
          ]
        },
        "options": {}
      },
      "id": "c1d33317-6b98-4d40-970f-6bd1a9a4f84c",
      "name": "Get replies9",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1660,
        8200
      ],
      "credentials": {
        "cloodoApi": {
          "id": "nP7U7wKTbfdSeafq",
          "name": "Cmsmart Worksuite account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "796ab7b7-b19f-4a08-938e-16c2e40a9325",
              "name": "replies",
              "value": "={{ $json.data }}",
              "type": "array"
            },
            {
              "id": "377ffdcb-97b2-4ab7-b211-3376a7437855",
              "name": "ticket",
              "value": "={{ $('Get Ticket6').item.json.data }}",
              "type": "object"
            }
          ]
        },
        "options": {}
      },
      "id": "9955e7a0-1e34-4808-8d2f-660e07553a89",
      "name": "Replies and Ticket9",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1900,
        8200
      ]
    },
    {
      "parameters": {
        "options": {}
      },
      "id": "87423876-f9ef-486c-a57b-1bc360f222b7",
      "name": "Loop Over Items3",
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        2400,
        8200
      ]
    },
    {
      "parameters": {
        "jsCode": "const currentDate = new Date();  // Ngày hiện tại\nconst daysLimit = 15;  // Số ngày bạn muốn so sánh\nconst filteredItems = [];\n\n// Lặp qua từng item trong $input.all() và kiểm tra update_at\nfor (const item of $input.all()) {\n  const updateDate = new Date(item?.json?.replies[0]?.created_at);  // Ngày cập nhật của item\n  const diffTime = currentDate - updateDate; // Tính sự khác biệt giữa ngày hiện tại và ngày update_at\n  const diffDays = diffTime / (1000 * 3600 * 24); // Chuyển từ milliseconds sang ngày\n  const idTicket = item?.json?.ticket?.id\n  const idClient = item?.json?.ticket?.requester?.id\n  const clientTicket = item?.json?.ticket?.requester?.name\n  const numberTicket = item?.json?.ticket?.ticket_number\n  const subjectTicket = item?.json?.ticket?.subject\n  const statusTicket = item?.json?.ticket?.status\n  const typeTicket = item?.json?.ticket?.type?.type\n  const projectTicket = item?.json?.ticket?.projects?.name\n  const agentNameTicket = item?.json?.ticket?.agent?.user?.name\n  const agentEmailTicket = item?.json?.ticket?.agent?.user?.email\n  const agentId = item?.json?.ticket?.agent?.user?.id\n  \n  if (diffDays > daysLimit) {\n    item.json.ticket = {idTicket: idTicket,\n                        idClient: idClient,\n                        nameClient: clientTicket,\n                        numberTicket: numberTicket,\n                        subjectTicket: subjectTicket,\n                        statusTicket: statusTicket,\n                        typeTicket: typeTicket,\n                        projectTicket: projectTicket,\n                        agentName: agentNameTicket,\n                        agentEmail: agentEmailTicket,\n                        agentId: agentId\n                       }\n    filteredItems.push(item);  // Thêm item vào danh sách nếu update_at sau 15 ngày\n  }\n}\n\nreturn filteredItems;  // Trả về các item thỏa mãn điều kiện\n"
      },
      "id": "b401ff57-3a7c-41d2-8c3f-ca3f294fa3c0",
      "name": "Ticket 15d1",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2140,
        8200
      ],
      "executeOnce": true
    },
    {
      "parameters": {
        "conditions": {
          "number": [
            {
              "value1": "={{ $json.total_records }}",
              "operation": "equal"
            }
          ]
        }
      },
      "id": "70423e3d-76a0-4c80-b26f-f4d5cd645cd5",
      "name": "IF not found4",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        2920,
        8220
      ]
    },
    {
      "parameters": {
        "operation": "minus",
        "user_id": "={{ $('Ticket 15d1').item.json.ticket.agentId }}",
        "points": "=5",
        "note": "=QCM 83-84: {{ $('Ticket 15d1').item.json.ticket.agentName }} -5 points Ticket no closed or Ticket no reply Client: https://worksuite.cloodo.com/apps/tickets/all-tickets/{{ $('Ticket 15d1').item.json.ticket.idTicket }}"
      },
      "id": "e97b898a-9b34-483c-bd7f-36e1a58034d4",
      "name": "Cloodo Point11",
      "type": "@cloodo/n8n-nodes-cloodo-point.cloodoPoint",
      "typeVersion": 1,
      "position": [
        3260,
        8200
      ],
      "credentials": {
        "cloodoApi2": {
          "id": "82nsSr6jMyGAQbyu",
          "name": "Cmsmart Point API Key"
        }
      }
    },
    {
      "parameters": {
        "operation": "search",
        "keyword": "=QCM 83-84: {{ $('Ticket 15d1').item.json.ticket.agentName }} -5 points Ticket no closed or Ticket no reply Client: https://worksuite.cloodo.com/apps/tickets/all-tickets/{{ $('Ticket 15d1').item.json.ticket.idTicket }}",
        "max_limit_record": 50
      },
      "id": "a6ec146d-2712-466c-a160-15c6b8e97d62",
      "name": "Cloodo Point12",
      "type": "@cloodo/n8n-nodes-cloodo-point.cloodoPoint",
      "typeVersion": 1,
      "position": [
        2700,
        8220
      ],
      "credentials": {
        "cloodoApi2": {
          "id": "82nsSr6jMyGAQbyu",
          "name": "Cmsmart Point API Key"
        }
      }
    },
    {
      "parameters": {
        "operation": "minus",
        "user_id": "={{ $('Ticket 8h1').item.json.ticket.agentId }}",
        "points": "={{ $('Cloodo Point14')?.item?.json?.data.length > 0 ? Math.min(...$('Cloodo Point14')?.item?.json?.data?.map(item => item?.point)?.map(Number)) * -1 + 5 : 5  }}",
        "note": "=QCM 83-84: {{ $('Ticket 8h1').item.json.ticket.agentName }} -{{ $('Cloodo Point14')?.item?.json?.data.length > 0 ? Math.min(...$('Cloodo Point14')?.item?.json?.data?.map(item => item?.point)?.map(Number)) * -1 + 5 : 5  }} points Ticket no closed or Ticket no reply Client: https://worksuite.cloodo.com/apps/tickets/all-tickets/{{ $('Ticket 8h1').item.json.ticket.idTicket }}"
      },
      "id": "2beb5a4d-99d8-4758-b02f-254bf79afc5c",
      "name": "Cloodo Point13",
      "type": "@cloodo/n8n-nodes-cloodo-point.cloodoPoint",
      "typeVersion": 1,
      "position": [
        3060,
        5640
      ],
      "credentials": {
        "cloodoApi2": {
          "id": "82nsSr6jMyGAQbyu",
          "name": "Cmsmart Point API Key"
        }
      }
    },
    {
      "parameters": {
        "operation": "search",
        "keyword": "=https://worksuite.cloodo.com/apps/tickets/all-tickets/{{ $('Ticket 8h1').item.json.ticket.idTicket }}",
        "max_limit_record": 50,
        "status_record": -1
      },
      "id": "61790706-2d03-4b92-9c0b-245920ba9eed",
      "name": "Cloodo Point14",
      "type": "@cloodo/n8n-nodes-cloodo-point.cloodoPoint",
      "typeVersion": 1,
      "position": [
        2840,
        5640
      ],
      "credentials": {
        "cloodoApi2": {
          "id": "82nsSr6jMyGAQbyu",
          "name": "Cmsmart Point API Key"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "id": "64a3ae6d-7f6f-4024-af0d-cbe51139e2fd",
      "name": "Loop Over Items4",
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        2580,
        5620
      ]
    },
    {
      "parameters": {
        "conditions": {
          "number": [
            {
              "value1": "={{ $json.total_records }}",
              "operation": "equal"
            }
          ]
        }
      },
      "id": "9ff215a1-6d0e-4f74-b2b2-2961da4a1e87",
      "name": "IF not found5",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        3100,
        6000
      ]
    },
    {
      "parameters": {
        "operation": "minus",
        "user_id": "={{ $('Ticket 15d2').item.json.replies[0].user.id }}",
        "points": "=5",
        "note": "=QCM 83-84: {{ $('Ticket 15d2').item.json.ticket.agentName }} -5 points Ticket no closed or Ticket no reply Client: https://worksuite.cloodo.com/apps/tickets/all-tickets/{{ $('Ticket 15d2').item.json.ticket.idTicket }}"
      },
      "id": "2c46ccfb-1c89-4382-86cc-4f1cbd8c0047",
      "name": "Cloodo Point15",
      "type": "@cloodo/n8n-nodes-cloodo-point.cloodoPoint",
      "typeVersion": 1,
      "position": [
        3380,
        5980
      ],
      "credentials": {
        "cloodoApi2": {
          "id": "82nsSr6jMyGAQbyu",
          "name": "Cmsmart Point API Key"
        }
      }
    },
    {
      "parameters": {
        "operation": "search",
        "keyword": "=QCM 83-84: {{ $('Ticket 15d2').item.json.ticket.agentName }} -5 points Ticket no closed or Ticket no reply Client: https://worksuite.cloodo.com/apps/tickets/all-tickets/{{ $('Ticket 15d2').item.json.ticket.idTicket }}",
        "max_limit_record": 50,
        "status_record": 0
      },
      "id": "aefc541e-34b8-4537-b650-40e7b72e36d3",
      "name": "Cloodo Point16",
      "type": "@cloodo/n8n-nodes-cloodo-point.cloodoPoint",
      "typeVersion": 1,
      "position": [
        2900,
        6000
      ],
      "credentials": {
        "cloodoApi2": {
          "id": "82nsSr6jMyGAQbyu",
          "name": "Cmsmart Point API Key"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "id": "ae7f6654-40b6-492e-8373-c94fe360776a",
      "name": "Loop Over Items5",
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        2580,
        5980
      ]
    },
    {
      "parameters": {
        "jsCode": "const currentDate = new Date();  // Ngày hiện tại\nconst daysLimit = 8;  // Số ngày bạn muốn so sánh\nconst filteredItems = [];\n\n// Lặp qua từng item trong $input.all() và kiểm tra update_at\nfor (const item of $input.all()) {\n  const updateDate = new Date(item?.json?.replies[0]?.updated_at);  // Ngày cập nhật của item\n  const diffTime = currentDate - updateDate; // Tính sự khác biệt giữa ngày hiện tại và ngày update_at\n  const diffDays = diffTime / (1000 * 3600); // Chuyển từ milliseconds sang ngày\n  const idTicket = item?.json?.ticket?.id\n  const idClient = item?.json?.ticket?.requester?.id\n  const clientTicket = item?.json?.ticket?.requester?.name\n  const numberTicket = item?.json?.ticket?.ticket_number\n  const subjectTicket = item?.json?.ticket?.subject\n  const statusTicket = item?.json?.ticket?.status\n  const typeTicket = item?.json?.ticket?.type?.type\n  const projectTicket = item?.json?.ticket?.projects?.name\n  const agentNameTicket = item?.json?.ticket?.agent?.user?.name\n  const agentEmailTicket = item?.json?.ticket?.agent?.user?.email\n  const agentId = item?.json?.ticket?.agent?.user?.id\n  \n  if (diffDays > daysLimit) {\n    item.json.ticket = {idTicket: idTicket,\n                        idClient: idClient,\n                        nameClient: clientTicket,\n                        numberTicket: numberTicket,\n                        subjectTicket: subjectTicket,\n                        statusTicket: statusTicket,\n                        typeTicket: typeTicket,\n                        projectTicket: projectTicket,\n                        agentName: agentNameTicket,\n                        agentEmail: agentEmailTicket,\n                        agentId: agentId\n                       }\n    filteredItems.push(item);  // Thêm item vào danh sách nếu update_at sau 15 ngày\n  }\n}\n\nreturn filteredItems;  // Trả về các item thỏa mãn điều kiện\n"
      },
      "id": "d1db5923-88d2-4bd2-b4cd-923bfca41add",
      "name": "Ticket 8h1",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1780,
        5640
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "6dc6657f-526c-4633-a42e-591e9f2e964d",
              "leftValue": "={{ $json.replies[0].user.id }}",
              "rightValue": "={{ $json.ticket.idClient }}",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "b5a9948d-377d-4a10-8da4-3e192cc5e0a1",
      "name": "Requester Replies8",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        1920,
        6380
      ]
    },
    {
      "parameters": {
        "operation": "minus",
        "user_id": "={{ $('Ticket 24h2').item.json.ticket.agentId }}",
        "points": "={{ Math.min(...$('Cloodo Point18').item.json.data?.map(item => item?.point).map(Number)) * -1 }}",
        "note": "=QCM 83-84: {{ $('Ticket 24h2').item.json.ticket.agentName }} -{{ Math.min(...$('Cloodo Point18').item.json.data?.map(item => item?.point).map(Number)) * -1 }} points Ticket no closed or Ticket no reply Client: https://worksuite.cloodo.com/apps/tickets/all-tickets/{{ $('Ticket 24h2').item.json.ticket.idTicket }}"
      },
      "id": "508ede59-ff02-4070-9bf1-f82d6c322bf8",
      "name": "Cloodo Point17",
      "type": "@cloodo/n8n-nodes-cloodo-point.cloodoPoint",
      "typeVersion": 1,
      "position": [
        2880,
        6280
      ],
      "credentials": {
        "cloodoApi2": {
          "id": "82nsSr6jMyGAQbyu",
          "name": "Cmsmart Point API Key"
        }
      }
    },
    {
      "parameters": {
        "operation": "search",
        "keyword": "=https://worksuite.cloodo.com/apps/tickets/all-tickets/{{ $('Ticket 24h2').item.json.ticket.idTicket }}",
        "max_limit_record": 50,
        "status_record": 0
      },
      "id": "41c82f5b-1e73-4593-9d6a-b9a0c5b962c6",
      "name": "Cloodo Point18",
      "type": "@cloodo/n8n-nodes-cloodo-point.cloodoPoint",
      "typeVersion": 1,
      "position": [
        2580,
        6280
      ],
      "credentials": {
        "cloodoApi2": {
          "id": "82nsSr6jMyGAQbyu",
          "name": "Cmsmart Point API Key"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "id": "fe76cd34-9bb7-4f12-98f7-ad034c8d9e41",
      "name": "Loop Over Items6",
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        2320,
        6260
      ]
    },
    {
      "parameters": {
        "options": {}
      },
      "id": "843329c7-443b-43f7-bddb-569d2bfe802c",
      "name": "Loop Over Items7",
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        2480,
        6620
      ]
    },
    {
      "parameters": {
        "conditions": {
          "number": [
            {
              "value1": "={{ $json.total_records }}",
              "operation": "equal"
            }
          ]
        }
      },
      "id": "707e9782-e747-4850-a194-6cf7d6f8bc3c",
      "name": "IF not found6",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        2980,
        6640
      ]
    },
    {
      "parameters": {
        "operation": "minus",
        "user_id": "={{ $('Ticket 15d3').item.json.replies[0].user.id }}",
        "points": "=5",
        "note": "=QCM 83-84: {{ $('Ticket 15d3').item.json.ticket.agentName }} -5 points Ticket no closed or Ticket no reply Client: https://worksuite.cloodo.com/apps/tickets/all-tickets/{{ $('Ticket 15d3').item.json.ticket.idTicket }}"
      },
      "id": "5e75b825-5169-4982-9d58-adae1b2aefc3",
      "name": "Cloodo Point19",
      "type": "@cloodo/n8n-nodes-cloodo-point.cloodoPoint",
      "typeVersion": 1,
      "position": [
        3260,
        6620
      ],
      "credentials": {
        "cloodoApi2": {
          "id": "82nsSr6jMyGAQbyu",
          "name": "Cmsmart Point API Key"
        }
      }
    },
    {
      "parameters": {
        "operation": "search",
        "keyword": "=QCM 83-84: {{ $('Ticket 15d3').item.json.ticket.agentName }} -5 points Ticket no closed or Ticket no reply Client: https://worksuite.cloodo.com/apps/tickets/all-tickets/{{ $('Ticket 15d3').item.json.ticket.idTicket }}",
        "max_limit_record": 50
      },
      "id": "5b1f352b-a7ba-478c-a649-026a37445c29",
      "name": "Cloodo Point20",
      "type": "@cloodo/n8n-nodes-cloodo-point.cloodoPoint",
      "typeVersion": 1,
      "position": [
        2760,
        6640
      ],
      "credentials": {
        "cloodoApi2": {
          "id": "82nsSr6jMyGAQbyu",
          "name": "Cmsmart Point API Key"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const currentDate = new Date();  // Ngày hiện tại\nconst daysLimit = 15;  // Số ngày bạn muốn so sánh\nconst filteredItems = [];\n\n// Lặp qua từng item trong $input.all() và kiểm tra update_at\nfor (const item of $input.all()) {\n  const updateDate = new Date(item?.json?.replies[0]?.updated_at);  // Ngày cập nhật của item\n  const diffTime = currentDate - updateDate; // Tính sự khác biệt giữa ngày hiện tại và ngày update_at\n  const diffDays = diffTime / (1000 * 3600 * 24); // Chuyển từ milliseconds sang ngày\n  const idTicket = item?.json?.ticket?.idTicket\n  const idClient = item?.json?.ticket?.idClient\n  const clientTicket = item?.json?.ticket?.nameClient\n  const numberTicket = item?.json?.ticket?.numberTicket\n  const subjectTicket = item?.json?.ticket?.subjectTicket\n  const statusTicket = item?.json?.ticket?.statusTicket\n  const typeTicket = item?.json?.ticket?.typeTicket\n  const projectTicket = item?.json?.ticket?.projectTicket\n  const agentNameTicket = item?.json?.ticket?.agentName\n  const agentEmailTicket = item?.json?.ticket?.agentEmail\n  \n  if (diffDays > daysLimit) {\n    item.json.ticket = {idTicket: idTicket,\n                        idClient: idClient,\n                        nameClient: clientTicket,\n                        numberTicket: numberTicket,\n                        subjectTicket: subjectTicket,\n                        statusTicket: statusTicket,\n                        typeTicket: typeTicket,\n                        projectTicket: projectTicket,\n                        agentName: agentNameTicket,\n                        agentEmail: agentEmailTicket\n                       }\n    filteredItems.push(item);  // Thêm item vào danh sách nếu update_at sau 15 ngày\n  }\n}\n\nreturn filteredItems;  // Trả về các item thỏa mãn điều kiện\n"
      },
      "id": "ddfdcd7f-f7cc-4bed-90a2-ae40379c31ce",
      "name": "Ticket 15d2",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2260,
        5980
      ]
    },
    {
      "parameters": {
        "jsCode": "const currentDate = new Date();  // Ngày hiện tại\nconst daysLimit = 15;  // Số ngày bạn muốn so sánh\nconst filteredItems = [];\n\n// Lặp qua từng item trong $input.all() và kiểm tra update_at\nfor (const item of $input.all()) {\n  const updateDate = new Date(item?.json?.replies[0]?.updated_at);  // Ngày cập nhật của item\n  const diffTime = currentDate - updateDate; // Tính sự khác biệt giữa ngày hiện tại và ngày update_at\n  const diffDays = diffTime / (1000 * 3600 * 24); // Chuyển từ milliseconds sang ngày\n  const idTicket = item?.json?.ticket?.idTicket\n  const idClient = item?.json?.ticket?.idClient\n  const clientTicket = item?.json?.ticket?.nameClient\n  const numberTicket = item?.json?.ticket?.numberTicket\n  const subjectTicket = item?.json?.ticket?.subjectTicket\n  const statusTicket = item?.json?.ticket?.statusTicket\n  const typeTicket = item?.json?.ticket?.typeTicket\n  const projectTicket = item?.json?.ticket?.projectTicket\n  const agentNameTicket = item?.json?.ticket?.agentName\n  const agentEmailTicket = item?.json?.ticket?.agentEmail\n  \n  if (diffDays > daysLimit) {\n    item.json.ticket = {idTicket: idTicket,\n                        idClient: idClient,\n                        nameClient: clientTicket,\n                        numberTicket: numberTicket,\n                        subjectTicket: subjectTicket,\n                        statusTicket: statusTicket,\n                        typeTicket: typeTicket,\n                        projectTicket: projectTicket,\n                        agentName: agentNameTicket,\n                        agentEmail: agentEmailTicket\n                       }\n    filteredItems.push(item);  // Thêm item vào danh sách nếu update_at sau 15 ngày\n  }\n}\n\nreturn filteredItems;  // Trả về các item thỏa mãn điều kiện\n"
      },
      "id": "bf6428da-f1b9-4277-a321-ad433e59db00",
      "name": "Ticket 15d3",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2260,
        6620
      ]
    },
    {
      "parameters": {
        "fieldToSplitOut": "data",
        "options": {}
      },
      "id": "6d0a5ab5-aa09-4829-afef-5beebfd73769",
      "name": "Item Lists",
      "type": "n8n-nodes-base.itemLists",
      "typeVersion": 3,
      "position": [
        1740,
        3360
      ]
    },
    {
      "parameters": {
        "url": "https://erp-amz.cloodo.com/v4/tickets",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "cloodoApi",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "limit",
              "value": "100"
            },
            {
              "name": "date_from",
              "value": "2025-01-01"
            },
            {
              "name": "date_to",
              "value": "={{ $now.toDateTime() }}"
            },
            {
              "name": "sort",
              "value": "desc"
            },
            {
              "name": "status",
              "value": "pending"
            },
            {
              "name": "cursor",
              "value": "={{ $json.meta.next_cursor }}"
            }
          ]
        },
        "options": {}
      },
      "id": "0550b230-82c1-4aae-8963-888f9119cbfb",
      "name": "Ticket Pending",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1440,
        3360
      ],
      "credentials": {
        "cloodoApi": {
          "id": "nP7U7wKTbfdSeafq",
          "name": "Cmsmart Worksuite account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $json.meta.next_cursor }}",
              "operation": "isNotEmpty"
            }
          ]
        }
      },
      "id": "16c97883-52c4-4652-b3ca-c8358c74b7b0",
      "name": "IF",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        1640,
        3540
      ]
    },
    {
      "parameters": {
        "url": "=https://erp-amz.cloodo.com/v4/tickets/{{ $json.data.id }}/replies",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "cloodoApi",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "limit",
              "value": "10"
            }
          ]
        },
        "options": {}
      },
      "id": "c06bf2e2-e3d8-44b2-b4e6-a37922a3d6e4",
      "name": "Get replies",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        2260,
        3360
      ],
      "credentials": {
        "cloodoApi": {
          "id": "nP7U7wKTbfdSeafq",
          "name": "Cmsmart Worksuite account"
        }
      }
    },
    {
      "parameters": {
        "resource": "engagement",
        "ID": "={{ $json.id }}",
        "requestOptions": {}
      },
      "id": "3e884e6d-791a-4a2c-b8d9-6742b6e654d2",
      "name": "Get Ticket",
      "type": "@cloodo/n8n-nodes-cloodo-crm.CloodoLeads",
      "typeVersion": 1,
      "position": [
        2000,
        3360
      ],
      "credentials": {
        "cloodoApi": {
          "id": "nP7U7wKTbfdSeafq",
          "name": "Cmsmart Worksuite account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "796ab7b7-b19f-4a08-938e-16c2e40a9325",
              "name": "replies",
              "value": "={{ $json.data }}",
              "type": "array"
            },
            {
              "id": "377ffdcb-97b2-4ab7-b211-3376a7437855",
              "name": "ticket",
              "value": "={{ $('Get Ticket').item.json.data }}",
              "type": "object"
            }
          ]
        },
        "options": {}
      },
      "id": "42677f19-a55f-4983-9754-5f0e4f93768c",
      "name": "Replies and Ticket",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2500,
        3360
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "6dc6657f-526c-4633-a42e-591e9f2e964d",
              "leftValue": "={{ $json.replies[0].user.id }}",
              "rightValue": "={{ $json.ticket.idClient }}",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "146a5abd-f25c-445a-8479-dd2c81e76825",
      "name": "Requester Replies",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        3000,
        3360
      ]
    },
    {
      "parameters": {
        "jsCode": "const currentDate = new Date();  // Ngày hiện tại\nconst daysLimit = 8;  // Số ngày bạn muốn so sánh\nconst filteredItems = [];\n\n// Lặp qua từng item trong $input.all() và kiểm tra update_at\nfor (const item of $input.all()) {\n  const updateDate = new Date(item?.json?.replies[0]?.updated_at);  // Ngày cập nhật của item\n  const diffTime = currentDate - updateDate; // Tính sự khác biệt giữa ngày hiện tại và ngày update_at\n  const diffDays = diffTime / (1000 * 3600); // Chuyển từ milliseconds sang ngày\n  const idTicket = item?.json?.ticket?.id\n  const idClient = item?.json?.ticket?.requester?.id\n  const clientTicket = item?.json?.ticket?.requester?.name\n  const numberTicket = item?.json?.ticket?.ticket_number\n  const subjectTicket = item?.json?.ticket?.subject\n  const statusTicket = item?.json?.ticket?.status\n  const typeTicket = item?.json?.ticket?.type?.type\n  const projectTicket = item?.json?.ticket?.projects?.name\n  const agentNameTicket = item?.json?.ticket?.agent?.user?.name\n  const agentEmailTicket = item?.json?.ticket?.agent?.user?.email\n  \n  if (diffDays > daysLimit) {\n    item.json.ticket = {idTicket: idTicket,\n                        idClient: idClient,\n                        nameClient: clientTicket,\n                        numberTicket: numberTicket,\n                        subjectTicket: subjectTicket,\n                        statusTicket: statusTicket,\n                        typeTicket: typeTicket,\n                        projectTicket: projectTicket,\n                        agentName: agentNameTicket,\n                        agentEmail: agentEmailTicket\n                       }\n    filteredItems.push(item);  // Thêm item vào danh sách nếu update_at sau 15 ngày\n  }\n}\n\nreturn filteredItems;  // Trả về các item thỏa mãn điều kiện\n"
      },
      "id": "1e7a5114-447c-4aa4-8dcd-9df1f033a059",
      "name": "Ticket 8h2",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2740,
        3360
      ]
    },
    {
      "parameters": {
        "jsCode": "const currentDate = new Date();  // Ngày hiện tại\nconst daysLimit = 15;  // Số ngày bạn muốn so sánh\nconst filteredItems = [];\n\n// Lặp qua từng item trong $input.all() và kiểm tra update_at\nfor (const item of $input.all()) {\n  const updateDate = new Date(item?.json?.replies[0]?.updated_at);  // Ngày cập nhật của item\n  const diffTime = currentDate - updateDate; // Tính sự khác biệt giữa ngày hiện tại và ngày update_at\n  const diffDays = diffTime / (1000 * 3600 * 24); // Chuyển từ milliseconds sang ngày\n  const idTicket = item?.json?.ticket?.idTicket\n  const idClient = item?.json?.ticket?.idClient\n  const clientTicket = item?.json?.ticket?.nameClient\n  const numberTicket = item?.json?.ticket?.numberTicket\n  const subjectTicket = item?.json?.ticket?.subjectTicket\n  const statusTicket = item?.json?.ticket?.statusTicket\n  const typeTicket = item?.json?.ticket?.typeTicket\n  const projectTicket = item?.json?.ticket?.projectTicket\n  const agentNameTicket = item?.json?.ticket?.agentName\n  const agentEmailTicket = item?.json?.ticket?.agentEmail\n  \n  if (diffDays > daysLimit) {\n    item.json.ticket = {idTicket: idTicket,\n                        idClient: idClient,\n                        nameClient: clientTicket,\n                        numberTicket: numberTicket,\n                        subjectTicket: subjectTicket,\n                        statusTicket: statusTicket,\n                        typeTicket: typeTicket,\n                        projectTicket: projectTicket,\n                        agentName: agentNameTicket,\n                        agentEmail: agentEmailTicket\n                       }\n    filteredItems.push(item);  // Thêm item vào danh sách nếu update_at sau 15 ngày\n  }\n}\n\nreturn filteredItems;  // Trả về các item thỏa mãn điều kiện\n"
      },
      "id": "1ae1ebb3-1eda-4ce3-9497-73ed701bac40",
      "name": "Ticket 15d4",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        3260,
        3700
      ]
    },
    {
      "parameters": {
        "fieldToSplitOut": "data",
        "options": {}
      },
      "id": "587882dc-08a7-4d74-82dc-18e43d4632f9",
      "name": "Item Lists8",
      "type": "n8n-nodes-base.itemLists",
      "typeVersion": 3,
      "position": [
        1720,
        4460
      ]
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $json.meta.next_cursor }}",
              "operation": "isNotEmpty"
            }
          ]
        }
      },
      "id": "7dc8c78a-b848-4372-840b-67b5467c3022",
      "name": "IF10",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        1600,
        4780
      ]
    },
    {
      "parameters": {
        "url": "=https://erp-amz.cloodo.com/v4/tickets/{{ $json.data.id }}/replies",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "cloodoApi",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "limit",
              "value": "10"
            }
          ]
        },
        "options": {}
      },
      "id": "bc83c320-e088-4a7f-8560-9a0b4f66f98a",
      "name": "Get replies10",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        2480,
        4440
      ],
      "credentials": {
        "cloodoApi": {
          "id": "nP7U7wKTbfdSeafq",
          "name": "Cmsmart Worksuite account"
        }
      }
    },
    {
      "parameters": {
        "resource": "engagement",
        "ID": "={{ $json.id }}",
        "requestOptions": {}
      },
      "id": "ab4c696e-6c06-4d51-abf1-faf21371bb7e",
      "name": "Get Ticket8",
      "type": "@cloodo/n8n-nodes-cloodo-crm.CloodoLeads",
      "typeVersion": 1,
      "position": [
        1960,
        4460
      ],
      "executeOnce": false,
      "credentials": {
        "cloodoApi": {
          "id": "nP7U7wKTbfdSeafq",
          "name": "Cmsmart Worksuite account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "796ab7b7-b19f-4a08-938e-16c2e40a9325",
              "name": "replies",
              "value": "={{ $json.data }}",
              "type": "array"
            },
            {
              "id": "377ffdcb-97b2-4ab7-b211-3376a7437855",
              "name": "ticket",
              "value": "={{ $('Get Ticket8').item.json.data }}",
              "type": "object"
            }
          ]
        },
        "options": {}
      },
      "id": "5c562ae1-f572-4786-a344-0e9b9a0ec7f2",
      "name": "Replies and Ticket10",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2720,
        4440
      ]
    },
    {
      "parameters": {
        "jsCode": "const currentDate = new Date();  // Ngày hiện tại\nconst daysLimit = 8;  // Số ngày bạn muốn so sánh\nconst filteredItems = [];\n\n// Lặp qua từng item trong $input.all() và kiểm tra update_at\nfor (const item of $input.all()) {\n  const updateDate = new Date(item?.json?.replies[0]?.created_at);  // Ngày cập nhật của item\n  const diffTime = currentDate - updateDate; // Tính sự khác biệt giữa ngày hiện tại và ngày update_at\n  const diffDays = diffTime / (1000 * 3600); // Chuyển từ milliseconds sang ngày\n  const idTicket = item?.json?.ticket?.id\n  const idClient = item?.json?.ticket?.requester?.id\n  const clientTicket = item?.json?.ticket?.requester?.name\n  const numberTicket = item?.json?.ticket?.ticket_number\n  const subjectTicket = item?.json?.ticket?.subject\n  const statusTicket = item?.json?.ticket?.status\n  const typeTicket = item?.json?.ticket?.type?.type\n  const projectTicket = item?.json?.ticket?.projects?.name\n  const agentNameTicket = item?.json?.ticket?.agent?.user?.name\n  const agentEmailTicket = item?.json?.ticket?.agent?.user?.email\n  \n  if (diffDays > daysLimit) {\n    item.json.ticket = {idTicket: idTicket,\n                        idClient: idClient,\n                        nameClient: clientTicket,\n                        numberTicket: numberTicket,\n                        subjectTicket: subjectTicket,\n                        statusTicket: statusTicket,\n                        typeTicket: typeTicket,\n                        projectTicket: projectTicket,\n                        agentName: agentNameTicket,\n                        agentEmail: agentEmailTicket\n                       }\n    filteredItems.push(item);  // Thêm item vào danh sách nếu update_at sau 15 ngày\n  }\n}\n\nreturn filteredItems;  // Trả về các item thỏa mãn điều kiện\n"
      },
      "id": "3ccddbe7-741e-4847-889d-bac6def37588",
      "name": "Ticket 8h3",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2960,
        4440
      ],
      "executeOnce": true
    },
    {
      "parameters": {
        "url": "https://erp-amz.cloodo.com/v4/tickets",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "cloodoApi",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "limit",
              "value": "100"
            },
            {
              "name": "date_from",
              "value": "2025-01-01"
            },
            {
              "name": "date_to",
              "value": "={{ $now.toDateTime() }}"
            },
            {
              "name": "sort",
              "value": "desc"
            },
            {
              "name": "status",
              "value": "open"
            },
            {
              "name": "cursor",
              "value": "={{ $json.meta.next_cursor }}"
            }
          ]
        },
        "options": {}
      },
      "id": "a8b7caff-1346-4678-9714-690403c0b22e",
      "name": "Ticket Open2",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1420,
        4460
      ],
      "credentials": {
        "cloodoApi": {
          "id": "nP7U7wKTbfdSeafq",
          "name": "Cmsmart Worksuite account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "9ab35c59-58f9-43a8-8026-b499641ff4cd",
              "leftValue": "={{ $json.data.requester.email }}",
              "rightValue": "={{ $json.data.create_by.email }}",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "8028908f-50f0-42c4-ba6e-dd4a2b3413ee",
      "name": "Check client send2",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        2180,
        4460
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "6dc6657f-526c-4633-a42e-591e9f2e964d",
              "leftValue": "={{ $json.replies[0].user.id }}",
              "rightValue": "={{ $json.ticket.idClient }}",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "ea974510-e410-4a39-bf2a-910a74f49548",
      "name": "Requester Replies7",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        3200,
        4440
      ]
    },
    {
      "parameters": {
        "url": "=https://erp-amz.cloodo.com/v4/tickets/{{ $json.data.id }}/replies",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "cloodoApi",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "limit",
              "value": "10"
            }
          ]
        },
        "options": {}
      },
      "id": "bdbae001-40ae-4340-8792-648e8b903c41",
      "name": "Get replies11",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        2440,
        4700
      ],
      "credentials": {
        "cloodoApi": {
          "id": "nP7U7wKTbfdSeafq",
          "name": "Cmsmart Worksuite account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "796ab7b7-b19f-4a08-938e-16c2e40a9325",
              "name": "replies",
              "value": "={{ $json.data }}",
              "type": "array"
            },
            {
              "id": "377ffdcb-97b2-4ab7-b211-3376a7437855",
              "name": "ticket",
              "value": "={{ $('Get Ticket8').item.json.data }}",
              "type": "object"
            }
          ]
        },
        "options": {}
      },
      "id": "21522f6a-007d-4d9f-854c-55b139bbcfa1",
      "name": "Replies and Ticket11",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2680,
        4700
      ]
    },
    {
      "parameters": {
        "jsCode": "const currentDate = new Date();  // Ngày hiện tại\nconst daysLimit = 15;  // Số ngày bạn muốn so sánh\nconst filteredItems = [];\n\n// Lặp qua từng item trong $input.all() và kiểm tra update_at\nfor (const item of $input.all()) {\n  const updateDate = new Date(item?.json?.replies[0]?.created_at);  // Ngày cập nhật của item\n  const diffTime = currentDate - updateDate; // Tính sự khác biệt giữa ngày hiện tại và ngày update_at\n  const diffDays = diffTime / (1000 * 3600 * 24); // Chuyển từ milliseconds sang ngày\n  const idTicket = item?.json?.ticket?.id\n  const idClient = item?.json?.ticket?.requester?.id\n  const clientTicket = item?.json?.ticket?.requester?.name\n  const numberTicket = item?.json?.ticket?.ticket_number\n  const subjectTicket = item?.json?.ticket?.subject\n  const statusTicket = item?.json?.ticket?.status\n  const typeTicket = item?.json?.ticket?.type?.type\n  const projectTicket = item?.json?.ticket?.projects?.name\n  const agentNameTicket = item?.json?.ticket?.agent?.user?.name\n  const agentEmailTicket = item?.json?.ticket?.agent?.user?.email\n  \n  if (diffDays > daysLimit) {\n    item.json.ticket = {idTicket: idTicket,\n                        idClient: idClient,\n                        nameClient: clientTicket,\n                        numberTicket: numberTicket,\n                        subjectTicket: subjectTicket,\n                        statusTicket: statusTicket,\n                        typeTicket: typeTicket,\n                        projectTicket: projectTicket,\n                        agentName: agentNameTicket,\n                        agentEmail: agentEmailTicket\n                       }\n    filteredItems.push(item);  // Thêm item vào danh sách nếu update_at sau 15 ngày\n  }\n}\n\nreturn filteredItems;  // Trả về các item thỏa mãn điều kiện\n"
      },
      "id": "29afe48e-f9d7-48a8-881e-2c44978ec1d3",
      "name": "Ticket 15d5",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2920,
        4700
      ],
      "executeOnce": true
    },
    {
      "parameters": {
        "content": "## Data 7AM",
        "height": 82.91852303373958,
        "width": 199.9385587801313
      },
      "id": "64ae827a-8f50-49a6-adb0-9bf2ff2c93f9",
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        500,
        3940
      ]
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "https://docs.google.com/spreadsheets/d/1lM_TG2ExLdbs1YoBcaFzBFscVqB3MOEFjBFnvE9kAa0/edit?gid=0#gid=0",
          "mode": "url"
        },
        "sheetName": {
          "__rl": true,
          "value": 2073353188,
          "mode": "list",
          "cachedResultName": "Chi",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lM_TG2ExLdbs1YoBcaFzBFscVqB3MOEFjBFnvE9kAa0/edit#gid=2073353188"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "idTicket": "={{ $json.ticket.idTicket }}",
            "numberTicket": "={{ $json.ticket.numberTicket }}",
            "agentName": "={{ $json.ticket.agentName }}",
            "agenEmail": "={{ $json.ticket.agentEmail }}",
            "nameClient": "={{ $json.ticket.nameClient }}",
            "subjectTicket": "={{ $json.ticket.subjectTicket }}",
            "statusTicket": "={{ $json.ticket.statusTicket }}",
            "typeTicket": "={{ $json.ticket.typeTicket }}",
            "projectTicket": "={{ $json.ticket.projectTicket }}",
            "lastRespone": "Agent"
          },
          "matchingColumns": [
            "idTicket"
          ],
          "schema": [
            {
              "id": "idTicket",
              "displayName": "idTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "numberTicket",
              "displayName": "numberTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "agentName",
              "displayName": "agentName",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "agenEmail",
              "displayName": "agenEmail",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "lastRespone",
              "displayName": "lastRespone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "nameClient",
              "displayName": "nameClient",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "subjectTicket",
              "displayName": "subjectTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "statusTicket",
              "displayName": "statusTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "typeTicket",
              "displayName": "typeTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "projectTicket",
              "displayName": "projectTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ]
        },
        "options": {}
      },
      "id": "7244a0fe-6318-4ce3-ac16-a543704894eb",
      "name": "Chi7",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        3920,
        3720
      ],
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "P5h6CdXmV7twphIt",
          "name": "Canh Google Sheets"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "2a75c8aa-0ad9-4171-b215-7ddea1d07bd8",
                    "leftValue": "={{ $json.ticket.agentEmail }}",
                    "rightValue": "phuong.nt@netbasejsc.com",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Phuong"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "c01ba01c-39bd-41c7-82c6-cc9a876741d2",
                    "leftValue": "={{ $json.ticket.agentEmail }}",
                    "rightValue": "huy.nhd@netbasejsc.com",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Huy"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "7add08a8-dffe-44d7-b27c-73344547b865",
                    "leftValue": "={{ $json.ticket.agentEmail }}",
                    "rightValue": "chi.hu@netbasejsc.com",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Chi"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "1591f407-008f-43ca-b641-27b4d699617d",
                    "leftValue": "={{ $json.ticket.agentEmail }}",
                    "rightValue": "chau.lt@netbasejsc.com",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Chau"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "b33cb102-6f78-4a4d-9e88-5b2725a64274",
                    "leftValue": "={{ $json.ticket.agentEmail }}",
                    "rightValue": "",
                    "operator": {
                      "type": "string",
                      "operation": "notEmpty",
                      "singleValue": true
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "default"
            }
          ]
        },
        "options": {}
      },
      "id": "5851f036-37ce-4831-a030-20cdf978e7b5",
      "name": "Switch4",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        3520,
        4400
      ]
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "https://docs.google.com/spreadsheets/d/1lM_TG2ExLdbs1YoBcaFzBFscVqB3MOEFjBFnvE9kAa0/edit?gid=0#gid=0",
          "mode": "url"
        },
        "sheetName": {
          "__rl": true,
          "value": 1289877611,
          "mode": "list",
          "cachedResultName": "Huy",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lM_TG2ExLdbs1YoBcaFzBFscVqB3MOEFjBFnvE9kAa0/edit#gid=1289877611"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "idTicket": "={{ $json.ticket.idTicket }}",
            "agenEmail": "={{ $json.ticket.agentEmail }}",
            "numberTicket": "={{ $json.ticket.numberTicket }}",
            "agentName": "={{ $json.ticket.agentName }}",
            "lastRespone": "Client",
            "nameClient": "={{ $json.ticket.nameClient }}",
            "typeTicket": "={{ $json.ticket.typeTicket }}",
            "subjectTicket": "={{ $json.ticket.subjectTicket }}",
            "statusTicket": "={{ $json.ticket.statusTicket }}",
            "projectTicket": "={{ $json.ticket.projectTicket }}"
          },
          "matchingColumns": [
            "idTicket"
          ],
          "schema": [
            {
              "id": "idTicket",
              "displayName": "idTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "numberTicket",
              "displayName": "numberTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "agentName",
              "displayName": "agentName",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "agenEmail",
              "displayName": "agenEmail",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "lastRespone",
              "displayName": "lastRespone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "nameClient",
              "displayName": "nameClient",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "subjectTicket",
              "displayName": "subjectTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "statusTicket",
              "displayName": "statusTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "typeTicket",
              "displayName": "typeTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "projectTicket",
              "displayName": "projectTicket",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ]
        },
        "options": {}
      },
      "id": "12ca62ab-9882-4fc1-b431-6c295eb90ec8",
      "name": "Huy",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        3880,
        4280
      ],
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "P5h6CdXmV7twphIt",
          "name": "Canh Google Sheets"
        }
      }
    },
    {
      "parameters": {
        "content": "## SendMail 7:30AM",
        "height": 80,
        "width": 239.32079071092122,
        "color": 3
      },
      "id": "329491db-022c-4efb-8a29-a569a3c8538d",
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        4940,
        3780
      ]
    },
    {
      "parameters": {
        "content": "## Warning 8AM",
        "height": 80,
        "color": 5
      },
      "id": "05ce93ae-0827-4d5d-9114-83ce29d6ac0b",
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -1260,
        6460
      ]
    },
    {
      "parameters": {
        "content": "## Success 8PM",
        "height": 80,
        "color": 6
      },
      "id": "5bf78e7c-ab1a-48ed-bef6-2d39fd7b5c57",
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -1260,
        6660
      ]
    },
    {
      "parameters": {
        "content": "## Delete Sheet 22PM",
        "height": 80,
        "width": 261.73469725052115,
        "color": 7
      },
      "id": "75983b95-cefe-4e21-96e1-ebb845de2972",
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        4380,
        5840
      ]
    },
    {
      "parameters": {
        "operation": "delete",
        "documentId": {
          "__rl": true,
          "value": "https://docs.google.com/spreadsheets/d/1lM_TG2ExLdbs1YoBcaFzBFscVqB3MOEFjBFnvE9kAa0/edit?gid=0#gid=0",
          "mode": "url"
        },
        "sheetName": {
          "__rl": true,
          "value": 1298489612,
          "mode": "list",
          "cachedResultName": "Phuong",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lM_TG2ExLdbs1YoBcaFzBFscVqB3MOEFjBFnvE9kAa0/edit#gid=1298489612"
        },
        "numberToDelete": 50
      },
      "id": "6960c229-9d32-4638-9519-62dc0183def1",
      "name": "Phuong",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        5320,
        6060
      ],
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "P5h6CdXmV7twphIt",
          "name": "Canh Google Sheets"
        }
      }
    },
    {
      "parameters": {
        "operation": "delete",
        "documentId": {
          "__rl": true,
          "value": "https://docs.google.com/spreadsheets/d/1lM_TG2ExLdbs1YoBcaFzBFscVqB3MOEFjBFnvE9kAa0/edit?gid=0#gid=0",
          "mode": "url"
        },
        "sheetName": {
          "__rl": true,
          "value": 1289877611,
          "mode": "list",
          "cachedResultName": "Huy",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lM_TG2ExLdbs1YoBcaFzBFscVqB3MOEFjBFnvE9kAa0/edit#gid=1289877611"
        },
        "numberToDelete": 50
      },
      "id": "d8aa6394-deb2-4eed-b0fb-d8d6fc49202d",
      "name": "Huy3",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        5320,
        5900
      ],
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "P5h6CdXmV7twphIt",
          "name": "Canh Google Sheets"
        }
      }
    },
    {
      "parameters": {
        "operation": "delete",
        "documentId": {
          "__rl": true,
          "value": "https://docs.google.com/spreadsheets/d/1lM_TG2ExLdbs1YoBcaFzBFscVqB3MOEFjBFnvE9kAa0/edit?gid=0#gid=0",
          "mode": "url"
        },
        "sheetName": {
          "__rl": true,
          "value": 2073353188,
          "mode": "list",
          "cachedResultName": "Chi",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lM_TG2ExLdbs1YoBcaFzBFscVqB3MOEFjBFnvE9kAa0/edit#gid=2073353188"
        },
        "numberToDelete": 50
      },
      "id": "f7c921b7-9520-4615-81da-bea35f3ab267",
      "name": "Chi",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        5320,
        6240
      ],
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "P5h6CdXmV7twphIt",
          "name": "Canh Google Sheets"
        }
      }
    },
    {
      "parameters": {
        "operation": "delete",
        "documentId": {
          "__rl": true,
          "value": "https://docs.google.com/spreadsheets/d/1lM_TG2ExLdbs1YoBcaFzBFscVqB3MOEFjBFnvE9kAa0/edit?gid=0#gid=0",
          "mode": "url"
        },
        "sheetName": {
          "__rl": true,
          "value": 548962283,
          "mode": "list",
          "cachedResultName": "Chau",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1lM_TG2ExLdbs1YoBcaFzBFscVqB3MOEFjBFnvE9kAa0/edit#gid=548962283"
        },
        "numberToDelete": 50
      },
      "id": "43de0b0f-121a-4055-94a5-e50fbb1269e1",
      "name": "Chau",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        5340,
        6400
      ],
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "P5h6CdXmV7twphIt",
          "name": "Canh Google Sheets"
        }
      }
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {}
          ]
        }
      },
      "id": "f15da764-a0c4-4086-9a70-535eaf987a02",
      "name": "Schedule Trigger",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        460,
        460
      ]
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "weeks",
              "triggerAtDay": [
                1,
                2,
                3,
                4,
                5
              ],
              "triggerAtHour": 7
            }
          ]
        }
      },
      "id": "997d29ab-b6c0-4b0f-bc8d-82c83913c30e",
      "name": "Schedule Trigger1",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        680,
        4100
      ]
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "weeks",
              "triggerAtDay": [
                1,
                2,
                3,
                4,
                5
              ],
              "triggerAtHour": 7,
              "triggerAtMinute": 30
            }
          ]
        }
      },
      "id": "ce474d70-19bc-4441-84f0-cb5d67fcfc91",
      "name": "Schedule Trigger2",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        4940,
        4320
      ]
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "weeks",
              "triggerAtDay": [
                1,
                2,
                3,
                4,
                5
              ],
              "triggerAtHour": 22
            }
          ]
        }
      },
      "id": "33638595-2d34-4997-9979-c842c7d5de1f",
      "name": "Schedule Trigger3",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        4480,
        6240
      ]
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "weeks",
              "triggerAtDay": [
                1,
                2,
                3,
                4,
                5
              ],
              "triggerAtHour": 8
            }
          ]
        }
      },
      "id": "4e337b34-7880-4ac6-b2d9-a02cec1320d3",
      "name": "Schedule Trigger4",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        -720,
        6820
      ]
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "weeks",
              "triggerAtDay": [
                1,
                2,
                3,
                4,
                5
              ],
              "triggerAtHour": 20
            }
          ]
        }
      },
      "id": "c5e9f712-0324-43dd-96bf-b29ed9514535",
      "name": "Schedule Trigger5",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        -720,
        7400
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "5736698d-d7ea-4102-8f3e-cd1a4c10fd90",
              "leftValue": "={{ $json.agentName }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "55b3b65b-288b-413d-b378-b1b28d20b213",
      "name": "If",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        5660,
        3940
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "5736698d-d7ea-4102-8f3e-cd1a4c10fd90",
              "leftValue": "={{ $json.agentName }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "31dc187d-24d9-44c3-83ff-3bdab0e62955",
      "name": "If1",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        5640,
        3420
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "5736698d-d7ea-4102-8f3e-cd1a4c10fd90",
              "leftValue": "={{ $json.agentName }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "b21ce5d4-51f4-42c5-b173-91cb124663bb",
      "name": "If2",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        5720,
        4400
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "5736698d-d7ea-4102-8f3e-cd1a4c10fd90",
              "leftValue": "={{ $json.agentName }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "138c2ba4-f502-40b5-8844-084bd0fea0e8",
      "name": "If3",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        5740,
        4840
      ]
    },
    {
      "parameters": {
        "fieldToSplitOut": "data",
        "options": {}
      },
      "id": "b2bf65be-a27b-483d-9f0e-952f5f35f893",
      "name": "Item Lists9",
      "type": "n8n-nodes-base.itemLists",
      "typeVersion": 3,
      "position": [
        -1620,
        4960
      ]
    },
    {
      "parameters": {
        "url": "https://erp-amz.cloodo.com/v4/tickets",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "cloodoApi",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "limit",
              "value": "100"
            },
            {
              "name": "date_from",
              "value": "2025-01-01"
            },
            {
              "name": "date_to",
              "value": "={{ $now.toDateTime() }}"
            },
            {
              "name": "sort",
              "value": "desc"
            },
            {
              "name": "status",
              "value": "pending"
            },
            {
              "name": "cursor",
              "value": "={{ $json.meta.next_cursor }}"
            }
          ]
        },
        "options": {}
      },
      "id": "fbd67c8a-79b7-4dc8-bae9-d16dcf118dbf",
      "name": "Ticket Pending6",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -1920,
        4960
      ],
      "credentials": {
        "cloodoApi": {
          "id": "nP7U7wKTbfdSeafq",
          "name": "Cmsmart Worksuite account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $json.meta.next_cursor }}",
              "operation": "isNotEmpty"
            }
          ]
        }
      },
      "id": "ba4ffe32-0d16-45c5-a938-9a3a9a321166",
      "name": "IF11",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        -1720,
        5140
      ]
    },
    {
      "parameters": {
        "url": "=https://erp-amz.cloodo.com/v4/tickets/{{ $json.data.id }}/replies",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "cloodoApi",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "limit",
              "value": "10"
            }
          ]
        },
        "options": {}
      },
      "id": "c693fb5e-95af-4e52-a17a-73ad63ea9c28",
      "name": "Get replies12",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -1100,
        4960
      ],
      "credentials": {
        "cloodoApi": {
          "id": "nP7U7wKTbfdSeafq",
          "name": "Cmsmart Worksuite account"
        }
      }
    },
    {
      "parameters": {
        "resource": "engagement",
        "ID": "={{ $json.id }}",
        "requestOptions": {}
      },
      "id": "945407be-b6d1-4092-a1cb-6b0ab8d26250",
      "name": "Get Ticket9",
      "type": "@cloodo/n8n-nodes-cloodo-crm.CloodoLeads",
      "typeVersion": 1,
      "position": [
        -1360,
        4960
      ],
      "credentials": {
        "cloodoApi": {
          "id": "nP7U7wKTbfdSeafq",
          "name": "Cmsmart Worksuite account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "796ab7b7-b19f-4a08-938e-16c2e40a9325",
              "name": "replies",
              "value": "={{ $json.data }}",
              "type": "array"
            },
            {
              "id": "377ffdcb-97b2-4ab7-b211-3376a7437855",
              "name": "ticket",
              "value": "={{ $('Get Ticket9').item.json.data }}",
              "type": "object"
            }
          ]
        },
        "options": {}
      },
      "id": "022638a3-3487-4a8f-98c2-f99bf354a1a8",
      "name": "Replies and Ticket12",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -860,
        4960
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "6dc6657f-526c-4633-a42e-591e9f2e964d",
              "leftValue": "={{ $json.replies[0].user.id }}",
              "rightValue": "={{ $json.ticket.idClient }}",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "568383fe-a8a9-4e56-a905-b19cb8f198f8",
      "name": "Requester Replies9",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -360,
        4960
      ]
    },
    {
      "parameters": {
        "jsCode": "const currentDate = new Date();  // Ngày hiện tại\nconst daysLimit = 8;  // Số ngày bạn muốn so sánh\nconst filteredItems = [];\n\n// Lặp qua từng item trong $input.all() và kiểm tra update_at\nfor (const item of $input.all()) {\n  const updateDate = new Date(item?.json?.replies[0]?.updated_at);  // Ngày cập nhật của item\n  const diffTime = currentDate - updateDate; // Tính sự khác biệt giữa ngày hiện tại và ngày update_at\n  const diffDays = diffTime / (1000 * 3600); // Chuyển từ milliseconds sang ngày\n  const idTicket = item?.json?.ticket?.id\n  const idClient = item?.json?.ticket?.requester?.id\n  const clientTicket = item?.json?.ticket?.requester?.name\n  const numberTicket = item?.json?.ticket?.ticket_number\n  const subjectTicket = item?.json?.ticket?.subject\n  const statusTicket = item?.json?.ticket?.status\n  const typeTicket = item?.json?.ticket?.type?.type\n  const projectTicket = item?.json?.ticket?.projects?.name\n  const agentNameTicket = item?.json?.ticket?.agent?.user?.name\n  const agentEmailTicket = item?.json?.ticket?.agent?.user?.email\n  const agentId = item?.json?.ticket?.agent?.user?.id\n  \n  if (diffDays > daysLimit) {\n    item.json.ticket = {idTicket: idTicket,\n                        idClient: idClient,\n                        nameClient: clientTicket,\n                        numberTicket: numberTicket,\n                        subjectTicket: subjectTicket,\n                        statusTicket: statusTicket,\n                        typeTicket: typeTicket,\n                        projectTicket: projectTicket,\n                        agentName: agentNameTicket,\n                        agentEmail: agentEmailTicket,\n                        agentId: agentId\n                       }\n    filteredItems.push(item);  // Thêm item vào danh sách nếu update_at sau 15 ngày\n  }\n}\n\nreturn filteredItems;  // Trả về các item thỏa mãn điều kiện\n"
      },
      "id": "ac85cda3-1fb6-49e3-b108-5b730a5b465b",
      "name": "Ticket 8h4",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -620,
        4960
      ]
    },
    {
      "parameters": {
        "jsCode": "const currentDate = new Date();  // Ngày hiện tại\nconst daysLimit = 15;  // Số ngày bạn muốn so sánh\nconst filteredItems = [];\n\n// Lặp qua từng item trong $input.all() và kiểm tra update_at\nfor (const item of $input.all()) {\n  const updateDate = new Date(item?.json?.replies[0]?.updated_at);  // Ngày cập nhật của item\n  const diffTime = currentDate - updateDate; // Tính sự khác biệt giữa ngày hiện tại và ngày update_at\n  const diffDays = diffTime / (1000 * 3600 * 24); // Chuyển từ milliseconds sang ngày\n  const idTicket = item?.json?.ticket?.idTicket\n  const idClient = item?.json?.ticket?.idClient\n  const clientTicket = item?.json?.ticket?.nameClient\n  const numberTicket = item?.json?.ticket?.numberTicket\n  const subjectTicket = item?.json?.ticket?.subjectTicket\n  const statusTicket = item?.json?.ticket?.statusTicket\n  const typeTicket = item?.json?.ticket?.typeTicket\n  const projectTicket = item?.json?.ticket?.projectTicket\n  const agentNameTicket = item?.json?.ticket?.agentName\n  const agentEmailTicket = item?.json?.ticket?.agentEmail\n  \n  if (diffDays > daysLimit) {\n    item.json.ticket = {idTicket: idTicket,\n                        idClient: idClient,\n                        nameClient: clientTicket,\n                        numberTicket: numberTicket,\n                        subjectTicket: subjectTicket,\n                        statusTicket: statusTicket,\n                        typeTicket: typeTicket,\n                        projectTicket: projectTicket,\n                        agentName: agentNameTicket,\n                        agentEmail: agentEmailTicket\n                       }\n    filteredItems.push(item);  // Thêm item vào danh sách nếu update_at sau 15 ngày\n  }\n}\n\nreturn filteredItems;  // Trả về các item thỏa mãn điều kiện\n"
      },
      "id": "18e5d63a-71fb-4775-9827-0aba5d4d29ca",
      "name": "Ticket 15d6",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -140,
        5300
      ]
    },
    {
      "parameters": {
        "options": {}
      },
      "id": "28b7b488-8129-4f3b-8ad7-3d1c1a7d9f0f",
      "name": "Loop Over Items8",
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        80,
        5300
      ]
    },
    {
      "parameters": {
        "resource": "engagement",
        "operation": "update",
        "ID": "={{ $json.ticket.idTicket }}",
        "additionalFields": {
          "statusId": "closed"
        },
        "requestOptions": {}
      },
      "id": "40ef0c17-06b0-4855-8720-0fa84d75a99f",
      "name": "Cloodo CRM10",
      "type": "@cloodo/n8n-nodes-cloodo-crm.CloodoLeads",
      "typeVersion": 1,
      "position": [
        380,
        5320
      ],
      "credentials": {
        "cloodoApi": {
          "id": "nP7U7wKTbfdSeafq",
          "name": "Cmsmart Worksuite account"
        }
      }
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "weeks",
              "triggerAtDay": [
                1,
                2,
                3,
                4,
                5
              ],
              "triggerAtHour": 23
            }
          ]
        }
      },
      "id": "66697f63-c50a-4cb1-82cc-9d13e6ef753d",
      "name": "Schedule Trigger6",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        -2140,
        4640
      ]
    }
  ],
  "pinData": {},
  "connections": {
    "Aggregate2": {
      "main": [
        [
          {
            "node": "Send mail closed ticket8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Phuong2": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate4": {
      "main": [
        [
          {
            "node": "Send mail closed ticket2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate5": {
      "main": [
        [
          {
            "node": "Send mail Reply Ticket2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Huy2": {
      "main": [
        [
          {
            "node": "If1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate6": {
      "main": [
        [
          {
            "node": "Send mail closed ticket3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate7": {
      "main": [
        [
          {
            "node": "Send mail Reply Ticket3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Chi2": {
      "main": [
        [
          {
            "node": "If2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate8": {
      "main": [
        [
          {
            "node": "Send mail closed ticket4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate9": {
      "main": [
        [
          {
            "node": "Send mail Reply Ticket4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Chau2": {
      "main": [
        [
          {
            "node": "If3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check Agent Reply2": {
      "main": [
        [
          {
            "node": "Aggregate4",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Aggregate5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check Agent Reply3": {
      "main": [
        [
          {
            "node": "Aggregate6",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Aggregate7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check Agent Reply1": {
      "main": [
        [
          {
            "node": "Aggregate2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Aggregate3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check Agent Reply4": {
      "main": [
        [
          {
            "node": "Aggregate8",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Aggregate9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Item Lists4": {
      "main": [
        [
          {
            "node": "Get Ticket4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Ticket Pending4": {
      "main": [
        [
          {
            "node": "Item Lists4",
            "type": "main",
            "index": 0
          },
          {
            "node": "IF8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get replies4": {
      "main": [
        [
          {
            "node": "Replies and Ticket4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Ticket4": {
      "main": [
        [
          {
            "node": "Get replies4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Replies and Ticket4": {
      "main": [
        [
          {
            "node": "Ticket 8h1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Item Lists5": {
      "main": [
        [
          {
            "node": "Get Ticket5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Ticket Pending5": {
      "main": [
        [
          {
            "node": "Item Lists5",
            "type": "main",
            "index": 0
          },
          {
            "node": "IF2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get replies5": {
      "main": [
        [
          {
            "node": "Replies and Ticket5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Ticket5": {
      "main": [
        [
          {
            "node": "Get replies5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Replies and Ticket5": {
      "main": [
        [
          {
            "node": "Ticket 24h2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Item Lists6": {
      "main": [
        [
          {
            "node": "Get Ticket6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get replies6": {
      "main": [
        [
          {
            "node": "Replies and Ticket6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Ticket6": {
      "main": [
        [
          {
            "node": "Check client send",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Replies and Ticket6": {
      "main": [
        [
          {
            "node": "Ticket 8h",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Item Lists7": {
      "main": [
        [
          {
            "node": "Get Ticket7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get replies7": {
      "main": [
        [
          {
            "node": "Replies and Ticket7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Replies and Ticket7": {
      "main": [
        [
          {
            "node": "Ticket 24h3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Ticket 24h2": {
      "main": [
        [
          {
            "node": "Requester Replies8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Ticket 24h3": {
      "main": [
        [
          {
            "node": "Requester Replies5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Cloodo Point5": {
      "main": [
        [
          {
            "node": "Cloodo Point4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Ticket 8h": {
      "main": [
        [
          {
            "node": "Requester Replies4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Ticket7": {
      "main": [
        [
          {
            "node": "Check client send1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Ticket Open": {
      "main": [
        [
          {
            "node": "Item Lists7",
            "type": "main",
            "index": 0
          },
          {
            "node": "IF3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Ticket Open1": {
      "main": [
        [
          {
            "node": "Item Lists6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Cloodo Point7": {
      "main": [
        [
          {
            "node": "Cloodo Point6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items": {
      "main": [
        [],
        [
          {
            "node": "Cloodo Point5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Cloodo Point4": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items1": {
      "main": [
        [],
        [
          {
            "node": "Cloodo Point7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check client send": {
      "main": [
        [
          {
            "node": "Get replies6",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Get replies8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check client send1": {
      "main": [
        [
          {
            "node": "Get replies7",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Get replies9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Requester Replies6": {
      "main": [
        [
          {
            "node": "Loop Over Items4",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Ticket 15d2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch5": {
      "main": [
        [
          {
            "node": "Phuong6",
            "type": "main",
            "index": 0
          }
        ],
        [],
        [
          {
            "node": "Chi6",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Chau6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch6": {
      "main": [
        [
          {
            "node": "Phuong7",
            "type": "main",
            "index": 0
          }
        ],
        [],
        [
          {
            "node": "Chi7",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Chau7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get replies8": {
      "main": [
        [
          {
            "node": "Replies and Ticket8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Replies and Ticket8": {
      "main": [
        [
          {
            "node": "Ticket 15d",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch7": {
      "main": [
        [
          {
            "node": "Phuong8",
            "type": "main",
            "index": 0
          }
        ],
        [],
        [
          {
            "node": "Chi8",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Chau8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Cloodo Point9": {
      "main": [
        [
          {
            "node": "Loop Over Items2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Cloodo Point10": {
      "main": [
        [
          {
            "node": "IF not found3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items2": {
      "main": [
        [],
        [
          {
            "node": "Cloodo Point10",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Requester Replies5": {
      "main": [
        [
          {
            "node": "Loop Over Items1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Cloodo Point6": {
      "main": [
        [
          {
            "node": "Loop Over Items1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF not found3": {
      "main": [
        [
          {
            "node": "Cloodo Point9",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Loop Over Items2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get replies9": {
      "main": [
        [
          {
            "node": "Replies and Ticket9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Replies and Ticket9": {
      "main": [
        [
          {
            "node": "Ticket 15d1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Ticket 15d1": {
      "main": [
        [
          {
            "node": "Loop Over Items3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF not found4": {
      "main": [
        [
          {
            "node": "Cloodo Point11",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Loop Over Items3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Cloodo Point12": {
      "main": [
        [
          {
            "node": "IF not found4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items3": {
      "main": [
        [],
        [
          {
            "node": "Cloodo Point12",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Cloodo Point11": {
      "main": [
        [
          {
            "node": "Loop Over Items3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Cloodo Point13": {
      "main": [
        [
          {
            "node": "Loop Over Items4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Cloodo Point14": {
      "main": [
        [
          {
            "node": "Cloodo Point13",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items4": {
      "main": [
        [],
        [
          {
            "node": "Cloodo Point14",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF not found5": {
      "main": [
        [
          {
            "node": "Cloodo Point15",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Loop Over Items5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Cloodo Point15": {
      "main": [
        [
          {
            "node": "Loop Over Items5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Cloodo Point16": {
      "main": [
        [
          {
            "node": "IF not found5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items5": {
      "main": [
        [],
        [
          {
            "node": "Cloodo Point16",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Ticket 8h1": {
      "main": [
        [
          {
            "node": "Requester Replies6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "When clicking ‘Test workflow’": {
      "main": [
        [
          {
            "node": "Ticket Pending6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Cloodo Point17": {
      "main": [
        [
          {
            "node": "Loop Over Items6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Cloodo Point18": {
      "main": [
        [
          {
            "node": "Cloodo Point17",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items6": {
      "main": [
        [],
        [
          {
            "node": "Cloodo Point18",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Requester Replies8": {
      "main": [
        [
          {
            "node": "Loop Over Items6",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Ticket 15d3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items7": {
      "main": [
        [],
        [
          {
            "node": "Cloodo Point20",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF not found6": {
      "main": [
        [
          {
            "node": "Cloodo Point19",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Loop Over Items7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Cloodo Point19": {
      "main": [
        [
          {
            "node": "Loop Over Items7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Cloodo Point20": {
      "main": [
        [
          {
            "node": "IF not found6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Ticket 15d3": {
      "main": [
        [
          {
            "node": "Loop Over Items7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate3": {
      "main": [
        [
          {
            "node": "Send mail Reply Ticket1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Item Lists": {
      "main": [
        [
          {
            "node": "Get Ticket",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Ticket Pending": {
      "main": [
        [
          {
            "node": "Item Lists",
            "type": "main",
            "index": 0
          },
          {
            "node": "IF",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get replies": {
      "main": [
        [
          {
            "node": "Replies and Ticket",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Ticket": {
      "main": [
        [
          {
            "node": "Get replies",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Replies and Ticket": {
      "main": [
        [
          {
            "node": "Ticket 8h2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Requester Replies": {
      "main": [
        [
          {
            "node": "Switch5",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Ticket 15d4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Ticket 8h2": {
      "main": [
        [
          {
            "node": "Requester Replies",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Item Lists8": {
      "main": [
        [
          {
            "node": "Get Ticket8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get replies10": {
      "main": [
        [
          {
            "node": "Replies and Ticket10",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Ticket8": {
      "main": [
        [
          {
            "node": "Check client send2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Replies and Ticket10": {
      "main": [
        [
          {
            "node": "Ticket 8h3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Ticket 8h3": {
      "main": [
        [
          {
            "node": "Requester Replies7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Ticket Open2": {
      "main": [
        [
          {
            "node": "Item Lists8",
            "type": "main",
            "index": 0
          },
          {
            "node": "IF10",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check client send2": {
      "main": [
        [
          {
            "node": "Get replies10",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Get replies11",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get replies11": {
      "main": [
        [
          {
            "node": "Replies and Ticket11",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Replies and Ticket11": {
      "main": [
        [
          {
            "node": "Ticket 15d5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Ticket 15d4": {
      "main": [
        [
          {
            "node": "Switch6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Requester Replies7": {
      "main": [
        [
          {
            "node": "Switch4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Ticket 15d5": {
      "main": [
        [
          {
            "node": "Switch7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch4": {
      "main": [
        [
          {
            "node": "Phuong5",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Huy",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Chi5",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Chau5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Ticket 15d2": {
      "main": [
        [
          {
            "node": "Loop Over Items5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Ticket 15d": {
      "main": [
        [
          {
            "node": "Loop Over Items2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Requester Replies4": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Schedule Trigger1": {
      "main": [
        [
          {
            "node": "Ticket Pending",
            "type": "main",
            "index": 0
          },
          {
            "node": "Ticket Open2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Schedule Trigger2": {
      "main": [
        [
          {
            "node": "Huy2",
            "type": "main",
            "index": 0
          },
          {
            "node": "Phuong2",
            "type": "main",
            "index": 0
          },
          {
            "node": "Chi2",
            "type": "main",
            "index": 0
          },
          {
            "node": "Chau2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Schedule Trigger3": {
      "main": [
        [
          {
            "node": "Huy3",
            "type": "main",
            "index": 0
          },
          {
            "node": "Phuong",
            "type": "main",
            "index": 0
          },
          {
            "node": "Chi",
            "type": "main",
            "index": 0
          },
          {
            "node": "Chau",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Schedule Trigger4": {
      "main": [
        [
          {
            "node": "Ticket Pending4",
            "type": "main",
            "index": 0
          },
          {
            "node": "Ticket Open1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Schedule Trigger5": {
      "main": [
        [
          {
            "node": "Ticket Pending5",
            "type": "main",
            "index": 0
          },
          {
            "node": "Ticket Open",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "Check Agent Reply1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If1": {
      "main": [
        [
          {
            "node": "Check Agent Reply2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If2": {
      "main": [
        [
          {
            "node": "Check Agent Reply3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If3": {
      "main": [
        [
          {
            "node": "Check Agent Reply4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Item Lists9": {
      "main": [
        [
          {
            "node": "Get Ticket9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Ticket Pending6": {
      "main": [
        [
          {
            "node": "Item Lists9",
            "type": "main",
            "index": 0
          },
          {
            "node": "IF11",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get replies12": {
      "main": [
        [
          {
            "node": "Replies and Ticket12",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Ticket9": {
      "main": [
        [
          {
            "node": "Get replies12",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Replies and Ticket12": {
      "main": [
        [
          {
            "node": "Ticket 8h4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Requester Replies9": {
      "main": [
        [],
        [
          {
            "node": "Ticket 15d6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Ticket 8h4": {
      "main": [
        [
          {
            "node": "Requester Replies9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Ticket 15d6": {
      "main": [
        [
          {
            "node": "Loop Over Items8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items8": {
      "main": [
        [],
        [
          {
            "node": "Cloodo CRM10",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Cloodo CRM10": {
      "main": [
        [
          {
            "node": "Loop Over Items8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Schedule Trigger6": {
      "main": [
        [
          {
            "node": "Ticket Pending6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "f1a446c6-bf27-4258-82eb-406c853b5eb4",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "3909475c03ca6926b6e6edc6a6f06c1feb448ce7ac700d69b17002085d9011f8"
  },
  "id": "vubqZHwkyMxeBNPX",
  "tags": []
}